PID 3558231 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 47:23] Using device: cuda
[INFO 47:23] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 0, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.003, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 47:44] Random_cont_model
[INFO 47:44] compiling CDM model
[INFO 47:49] compiling selection model
[INFO 47:49] ⏳ Début de l'entraînement...
[INFO 47:49] ✅ Entraînement terminé en 0.00 secondes.
[INFO 47:49] train on cuda
Meta_loss tensor(0.6983, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6965, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6948, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6932, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6916, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6901, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6887, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6873, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6859, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6846, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6834, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6821, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6809, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6798, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6786, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6776, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6765, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6754, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6744, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6734, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6725, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6715, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6706, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6697, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6688, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6679, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6671, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6663, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6655, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6647, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6639, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6631, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6624, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6616, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6609, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6602, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6595, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6588, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6581, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6575, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6568, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6562, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6556, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6550, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6544, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6538, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6532, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6527, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6521, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6516, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6510, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6505, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6500, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6495, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6490, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6485, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6480, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6475, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6471, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6467, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6462, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6458, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6453, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6449, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6445, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6441, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6437, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6433, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6429, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6425, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6422, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6418, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6415, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6411, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6408, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6405, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6401, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6398, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6395, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6392, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6389, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6386, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6383, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6380, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6377, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6374, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6372, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6369, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6366, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6364, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6361, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6359, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6357, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6354, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6352, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6350, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6348, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6346, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6344, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6342, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6340, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6338, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6336, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6334, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6332, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6331, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6329, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6327, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6326, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6324, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6323, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6321, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6320, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6319, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6317, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6316, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6315, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6314, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6313, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6312, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6310, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6310, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6309, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6308, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6307, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6306, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6305, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6305, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6304, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6303, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6302, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6302, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6301, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6300, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6300, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6299, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6299, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6298, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6298, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6298, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6296, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6298, device='cuda:0', grad_fn=<DotBackward0>)
---------- best_epoch : 157 ;   
[WARNING 48:31] Computing RM on meta and QUERY set
[INFO 48:34] RM: 0.34848270154288175
[INFO 48:34] Fold 0; results: ({'mi_acc': 0.6701245307922363, 'rmse': 0.5743479132652283, 'mae': 0.32987552881240845, 'mi_prec': 0.7743055820465088, 'mi_rec': 0.7034700512886047, 'mi_f_b': 0.7371901273727417, 'mi_auc': 0.6547653188031737, 'ma_prec': 0.6448847055435181, 'ma_rec': 0.6547653675079346, 'ma_f_b': 0.6471465826034546}, {'meta_doa': np.float64(0.5799167247041892), 'pc-er': 0.240966796875, 'rm': 0.34848270154288175})
