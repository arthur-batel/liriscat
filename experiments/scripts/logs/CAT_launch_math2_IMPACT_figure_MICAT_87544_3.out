PID 3325173 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 46:18] Using device: cuda
[INFO 46:18] #### config : {'seed': 0, 'dataset_name': 'math2', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.003, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 0, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 3, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0005, 'meta_lr': 0.01, 'meta_trainer': 'GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False, 'learning_users_emb_lr': 0.001} ####
[INFO 46:30] Random_cont_model
[INFO 46:31] compiling CDM model
[INFO 46:38] compiling selection model
[INFO 46:38] ⏳ Training started...
[INFO 46:38] ------- START Training
[INFO 46:38] train on cuda
[INFO 48:10] - meta_params: 0.01
[INFO 48:10] - cross_cond: 0.01
[INFO 48:10] - meta_lambda: 0.01
[INFO 48:10] - learning_users_emb: 0.001
[INFO 48:41] rmse : 0.5598241686820984
[INFO 48:41] valid_rmse : 0.7158876657485962
[INFO 48:41] valid_loss : 0.26135489344596863
[INFO 50:12] - meta_params: 0.01
[INFO 50:12] - cross_cond: 0.01
[INFO 50:12] - meta_lambda: 0.01
[INFO 50:12] - learning_users_emb: 0.001
[INFO 50:43] rmse : 0.560535728931427
[INFO 50:43] valid_rmse : 0.7167975902557373
[INFO 50:43] valid_loss : 0.2673512101173401
[INFO 52:16] - meta_params: 0.01
[INFO 52:16] - cross_cond: 0.01
[INFO 52:16] - meta_lambda: 0.01
[INFO 52:16] - learning_users_emb: 0.001
[INFO 52:47] rmse : 0.5626649856567383
[INFO 52:47] valid_rmse : 0.7195204496383667
[INFO 52:47] valid_loss : 0.2550196349620819
[INFO 54:19] - meta_params: 0.01
[INFO 54:19] - cross_cond: 0.01
[INFO 54:19] - meta_lambda: 0.01
[INFO 54:19] - learning_users_emb: 0.001
[INFO 54:50] rmse : 0.5575946569442749
[INFO 54:50] valid_rmse : 0.7130366563796997
[INFO 54:50] valid_loss : 0.30043718218803406
[INFO 56:24] - meta_params: 0.01
[INFO 56:24] - cross_cond: 0.01
[INFO 56:24] - meta_lambda: 0.01
[INFO 56:24] - learning_users_emb: 0.001
[INFO 56:54] rmse : 0.558755099773407
[INFO 56:54] valid_rmse : 0.7145205736160278
[INFO 56:54] valid_loss : 0.2478484958410263
[INFO 58:27] - meta_params: 0.01
[INFO 58:27] - cross_cond: 0.01
[INFO 58:27] - meta_lambda: 0.01
[INFO 58:27] - learning_users_emb: 0.001
[INFO 58:58] rmse : 0.5569688081741333
[INFO 58:58] valid_rmse : 0.7122362852096558
[INFO 58:58] valid_loss : 0.31271544098854065
[INFO 00:31] - meta_params: 0.01
[INFO 00:31] - cross_cond: 0.01
[INFO 00:31] - meta_lambda: 0.01
[INFO 00:31] - learning_users_emb: 0.001
[INFO 01:02] rmse : 0.5575946569442749
[INFO 01:02] valid_rmse : 0.7130366563796997
[INFO 01:02] valid_loss : 0.29403576254844666
[INFO 02:36] - meta_params: 0.01
[INFO 02:36] - cross_cond: 0.01
[INFO 02:36] - meta_lambda: 0.01
[INFO 02:36] - learning_users_emb: 0.001
[INFO 03:06] rmse : 0.5620447993278503
[INFO 03:06] valid_rmse : 0.7187273502349854
[INFO 03:06] valid_loss : 0.30180177092552185
[INFO 04:40] - meta_params: 0.005
[INFO 04:40] - cross_cond: 0.005
[INFO 04:40] - meta_lambda: 0.005
[INFO 04:40] - learning_users_emb: 0.0005
[INFO 05:11] rmse : 0.5583090782165527
[INFO 05:11] valid_rmse : 0.7139502167701721
[INFO 05:11] valid_loss : 0.2968147397041321
[INFO 06:44] - meta_params: 0.005
[INFO 06:44] - cross_cond: 0.005
[INFO 06:44] - meta_lambda: 0.005
[INFO 06:44] - learning_users_emb: 0.0005
[INFO 07:14] rmse : 0.5568793416023254
[INFO 07:14] valid_rmse : 0.7121219038963318
[INFO 07:14] valid_loss : 0.292580246925354
[INFO 08:47] - meta_params: 0.005
[INFO 08:47] - cross_cond: 0.005
[INFO 08:47] - meta_lambda: 0.005
[INFO 08:47] - learning_users_emb: 0.0005
[INFO 09:18] rmse : 0.5608022809028625
[INFO 09:18] valid_rmse : 0.7171384692192078
[INFO 09:18] valid_loss : 0.2761474847793579
[INFO 10:51] - meta_params: 0.0025
[INFO 10:51] - cross_cond: 0.0025
[INFO 10:51] - meta_lambda: 0.0025
[INFO 10:51] - learning_users_emb: 0.00025
[INFO 11:22] rmse : 0.5535589456558228
[INFO 11:22] valid_rmse : 0.7078758478164673
[INFO 11:22] valid_loss : 0.23139044642448425
[INFO 12:55] - meta_params: 0.0025
[INFO 12:55] - cross_cond: 0.0025
[INFO 12:55] - meta_lambda: 0.0025
[INFO 12:55] - learning_users_emb: 0.00025
[INFO 13:26] rmse : 0.5571476817131042
[INFO 13:26] valid_rmse : 0.7124650478363037
[INFO 13:26] valid_loss : 0.29578259587287903
[INFO 14:59] - meta_params: 0.0025
[INFO 14:59] - cross_cond: 0.0025
[INFO 14:59] - meta_lambda: 0.0025
[INFO 14:59] - learning_users_emb: 0.00025
[INFO 15:30] rmse : 0.5656678080558777
[INFO 15:30] valid_rmse : 0.7233603596687317
[INFO 15:30] valid_loss : 0.29963478446006775
[INFO 17:03] - meta_params: 0.0025
[INFO 17:03] - cross_cond: 0.0025
[INFO 17:03] - meta_lambda: 0.0025
[INFO 17:03] - learning_users_emb: 0.00025
[INFO 17:34] rmse : 0.563549816608429
[INFO 17:34] valid_rmse : 0.7206519246101379
[INFO 17:34] valid_loss : 0.23508745431900024
[INFO 19:07] - meta_params: 0.00125
[INFO 19:07] - cross_cond: 0.00125
[INFO 19:07] - meta_lambda: 0.00125
[INFO 19:07] - learning_users_emb: 0.000125
[INFO 19:38] rmse : 0.5613351464271545
[INFO 19:38] valid_rmse : 0.71781986951828
[INFO 19:38] valid_loss : 0.30158111453056335
[INFO 21:12] - meta_params: 0.00125
[INFO 21:12] - cross_cond: 0.00125
[INFO 21:12] - meta_lambda: 0.00125
[INFO 21:12] - learning_users_emb: 0.000125
[INFO 21:42] rmse : 0.560979962348938
[INFO 21:42] valid_rmse : 0.7173656821250916
[INFO 21:42] valid_loss : 0.3095256984233856
[INFO 23:16] - meta_params: 0.00125
[INFO 23:16] - cross_cond: 0.00125
[INFO 23:16] - meta_lambda: 0.00125
[INFO 23:16] - learning_users_emb: 0.000125
[INFO 23:47] rmse : 0.5590225458145142
[INFO 23:47] valid_rmse : 0.714862585067749
[INFO 23:47] valid_loss : 0.3006063997745514
[INFO 25:20] - meta_params: 0.000625
[INFO 25:20] - cross_cond: 0.000625
[INFO 25:20] - meta_lambda: 0.000625
[INFO 25:20] - learning_users_emb: 6.25e-05
[INFO 25:51] rmse : 0.5611575841903687
[INFO 25:51] valid_rmse : 0.7175927758216858
[INFO 25:51] valid_loss : 0.3020700216293335
[INFO 27:25] - meta_params: 0.000625
[INFO 27:25] - cross_cond: 0.000625
[INFO 27:25] - meta_lambda: 0.000625
[INFO 27:25] - learning_users_emb: 6.25e-05
[INFO 27:56] rmse : 0.5566108822822571
[INFO 27:56] valid_rmse : 0.7117785811424255
[INFO 27:56] valid_loss : 0.28360193967819214
[INFO 29:29] - meta_params: 0.000625
[INFO 29:29] - cross_cond: 0.000625
[INFO 29:29] - meta_lambda: 0.000625
[INFO 29:29] - learning_users_emb: 6.25e-05
[INFO 30:00] rmse : 0.5620447993278503
[INFO 30:00] valid_rmse : 0.7187273502349854
[INFO 30:00] valid_loss : 0.31801337003707886
[INFO 31:33] - meta_params: 0.0003125
[INFO 31:33] - cross_cond: 0.0003125
[INFO 31:33] - meta_lambda: 0.0003125
[INFO 31:33] - learning_users_emb: 3.125e-05
[INFO 32:04] rmse : 0.5600021481513977
[INFO 32:04] valid_rmse : 0.7161152362823486
[INFO 32:04] valid_loss : 0.2971031069755554
[INFO 33:37] - meta_params: 0.0003125
[INFO 33:37] - cross_cond: 0.0003125
[INFO 33:37] - meta_lambda: 0.0003125
[INFO 33:37] - learning_users_emb: 3.125e-05
[INFO 34:08] rmse : 0.5676900744438171
[INFO 34:08] valid_rmse : 0.7259463667869568
[INFO 34:08] valid_loss : 0.2855982780456543
[INFO 35:42] - meta_params: 0.0003125
[INFO 35:42] - cross_cond: 0.0003125
[INFO 35:42] - meta_lambda: 0.0003125
[INFO 35:42] - learning_users_emb: 3.125e-05
[INFO 36:12] rmse : 0.5532888174057007
[INFO 36:12] valid_rmse : 0.7075304388999939
[INFO 36:12] valid_loss : 0.29813477396965027
[INFO 37:46] - meta_params: 0.00015625
[INFO 37:46] - cross_cond: 0.00015625
[INFO 37:46] - meta_lambda: 0.00015625
[INFO 37:46] - learning_users_emb: 1.5625e-05
[INFO 38:16] rmse : 0.5575946569442749
[INFO 38:17] valid_rmse : 0.7130366563796997
[INFO 38:17] valid_loss : 0.3002926707267761
[INFO 39:50] - meta_params: 0.00015625
[INFO 39:50] - cross_cond: 0.00015625
[INFO 39:50] - meta_lambda: 0.00015625
[INFO 39:50] - learning_users_emb: 1.5625e-05
[INFO 40:21] rmse : 0.5630190968513489
[INFO 40:21] valid_rmse : 0.7199732661247253
[INFO 40:21] valid_loss : 0.30972179770469666
[INFO 41:55] - meta_params: 0.00015625
[INFO 41:55] - cross_cond: 0.00015625
[INFO 41:55] - meta_lambda: 0.00015625
[INFO 41:55] - learning_users_emb: 1.5625e-05
[INFO 42:26] rmse : 0.5621334314346313
[INFO 42:26] valid_rmse : 0.7188407182693481
[INFO 42:26] valid_loss : 0.28618142008781433
[INFO 42:26] -- END Training --
[INFO 42:26] ✅ Training completed in 3348.16 seconds.
[INFO 42:26] train on cuda
[WARNING 43:01] Computing RM on meta and QUERY set
[INFO 43:03] RM: 0.40824717830113527
[WARNING 43:05] Computing RM on meta and QUERY set
[INFO 43:05] RM: 0.4759802987406491
[WARNING 43:07] Computing RM on meta and QUERY set
[INFO 43:07] RM: 0.5242543314074951
[WARNING 43:09] Computing RM on meta and QUERY set
[INFO 43:09] RM: 0.5658692200227953
[WARNING 43:10] Computing RM on meta and QUERY set
[INFO 43:10] RM: 0.60103707084567
[WARNING 43:12] Computing RM on meta and QUERY set
[INFO 43:12] RM: 0.6356346970051098
[WARNING 43:13] Computing RM on meta and QUERY set
[INFO 43:13] RM: 0.666033039196969
[WARNING 43:15] Computing RM on meta and QUERY set
[INFO 43:15] RM: 0.6934130954941954
[WARNING 43:17] Computing RM on meta and QUERY set
[INFO 43:17] RM: 0.7192198035489803
[WARNING 43:18] Computing RM on meta and QUERY set
[INFO 43:18] RM: 0.7449542122299231
[WARNING 43:20] Computing RM on meta and QUERY set
[INFO 43:20] RM: 0.7687112914991637
[WARNING 43:22] Computing RM on meta and QUERY set
[INFO 43:22] RM: 0.7906403067107876
[WARNING 43:23] Computing RM on meta and QUERY set
[INFO 43:23] RM: 0.8105665935912504
[WARNING 43:25] Computing RM on meta and QUERY set
[INFO 43:25] RM: 0.8300773980120062
[WARNING 43:26] Computing RM on meta and QUERY set
[INFO 43:26] RM: 0.849107746864025
[WARNING 43:28] Computing RM on meta and QUERY set
[INFO 43:28] RM: 0.867379391575653
