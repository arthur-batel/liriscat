PID 3946716 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 58:21] Using device: cuda
[INFO 58:21] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'ncdm', 'i_fold': 3, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.001, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 58:38] Random_cont_model
../ckpt/assist0910_NCDM_fold_3_seed_0
[INFO 58:42] compiling selection model
[INFO 58:50] ⏳ Début de l'entraînement...
[INFO 58:50] ✅ Entraînement terminé en 0.00 secondes.
[INFO 58:50] train on cuda
Meta_loss tensor(0.9775, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9709, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9647, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9588, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9531, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9476, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9425, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9375, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9326, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9275, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9225, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9175, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9124, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9070, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9015, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8960, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8913, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8873, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8841, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8812, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8784, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8760, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8737, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8716, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8693, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8666, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8642, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8618, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8594, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8571, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8548, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8526, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8510, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8493, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8470, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8449, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8430, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8412, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8399, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8387, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8378, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8366, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8348, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8329, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8309, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8289, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8270, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8255, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8242, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8232, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8222, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8213, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8204, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8193, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8180, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8167, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8159, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8154, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8150, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8149, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8147, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8145, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8139, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8133, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8122, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8112, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8105, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8101, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8099, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8098, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8101, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8100, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8099, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8099, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8096, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8090, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8083, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8069, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8057, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8051, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8050, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8046, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8043, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8041, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8038, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8036, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8034, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8029, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8028, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8028, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8029, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8032, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8033, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8032, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8029, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8023, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8019, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8016, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8017, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8018, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8017, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8016, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8017, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8017, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8016, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8015, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8011, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8008, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8006, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8001, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7997, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7995, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7991, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7990, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7990, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7986, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7982, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7978, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7976, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7967, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7964, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7964, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7964, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7965, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7967, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7969, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7973, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7973, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7973, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7974, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7973, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7975, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7976, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
---------- best_epoch : 123 ;   
[WARNING 59:24] Computing RM on meta and QUERY set
[INFO 59:26] RM: -0.03742124835288506
[INFO 59:26] Fold 3; results: ({'mi_acc': 0.6515229940414429, 'rmse': 0.503133237361908, 'mae': 0.3841308653354645, 'mi_prec': 0.7445561289787292, 'mi_rec': 0.7061159610748291, 'mi_f_b': 0.7248266935348511, 'mi_auc': nan, 'ma_prec': 0.6232874989509583, 'ma_rec': 0.6281317472457886, 'ma_f_b': 0.6249045133590698}, {'meta_doa': np.float64(0.49090860841056144), 'pc-er': 0.0269927978515625, 'rm': -0.03742124835288506})
