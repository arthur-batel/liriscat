PID 2849082 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 51:17] Using device: cuda
[INFO 51:17] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 3, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0030272604785952922, 'meta_lr': 0.01, 'meta_trainer': 'Approx_GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 51:34] Random_cont_model
[INFO 51:35] compiling CDM model
[INFO 51:43] compiling selection model
[INFO 51:43] ⏳ Début de l'entraînement...
[INFO 51:43] ------- START Training
[INFO 51:43] train on cuda
[INFO 52:01] - meta_params: 0.01
[INFO 52:09] rmse : 0.5553086996078491
[INFO 52:09] valid_rmse : 1.3544114828109741
[INFO 52:09] valid_loss : 1.6742630004882812
[INFO 52:21] - meta_params: 0.01
[INFO 52:27] rmse : 0.5576292872428894
[INFO 52:27] valid_rmse : 1.3600714206695557
[INFO 52:27] valid_loss : 1.6773778200149536
[INFO 52:38] - meta_params: 0.01
[INFO 52:44] rmse : 0.5576292872428894
[INFO 52:44] valid_rmse : 1.3600714206695557
[INFO 52:44] valid_loss : 1.6723966598510742
[INFO 52:54] - meta_params: 0.01
[INFO 53:00] rmse : 0.5553086996078491
[INFO 53:00] valid_rmse : 1.3544114828109741
[INFO 53:00] valid_loss : 1.671779751777649
[INFO 53:10] - meta_params: 0.01
[INFO 53:16] rmse : 0.55901700258255
[INFO 53:16] valid_rmse : 1.363456130027771
[INFO 53:16] valid_loss : 1.6759811639785767
[INFO 53:25] - meta_params: 0.01
[INFO 53:31] rmse : 0.559478759765625
[INFO 53:31] valid_rmse : 1.3645824193954468
[INFO 53:31] valid_loss : 1.6744816303253174
[INFO 53:40] - meta_params: 0.01
[INFO 53:46] rmse : 0.5576292872428894
[INFO 53:46] valid_rmse : 1.3600714206695557
[INFO 53:46] valid_loss : 1.6767299175262451
[INFO 53:55] - meta_params: 0.005
[INFO 54:00] rmse : 0.5580922365188599
[INFO 54:00] valid_rmse : 1.3612005710601807
[INFO 54:00] valid_loss : 1.6769880056381226
[INFO 54:09] - meta_params: 0.005
[INFO 54:15] rmse : 0.5557736158370972
[INFO 54:15] valid_rmse : 1.3555454015731812
[INFO 54:15] valid_loss : 1.673753261566162
[INFO 54:24] - meta_params: 0.005
[INFO 54:29] rmse : 0.5548434257507324
[INFO 54:29] valid_rmse : 1.3532767295837402
[INFO 54:29] valid_loss : 1.67941153049469
[INFO 54:37] - meta_params: 0.0025
[INFO 54:43] rmse : 0.5580922365188599
[INFO 54:43] valid_rmse : 1.3612005710601807
[INFO 54:43] valid_loss : 1.6812995672225952
[INFO 54:51] - meta_params: 0.0025
[INFO 54:57] rmse : 0.5576292872428894
[INFO 54:57] valid_rmse : 1.3600714206695557
[INFO 54:57] valid_loss : 1.6749274730682373
[INFO 55:04] - meta_params: 0.0025
[INFO 55:10] rmse : 0.5562381148338318
[INFO 55:10] valid_rmse : 1.3566783666610718
[INFO 55:10] valid_loss : 1.6755197048187256
[INFO 55:18] - meta_params: 0.00125
[INFO 55:23] rmse : 0.5571659207344055
[INFO 55:23] valid_rmse : 1.3589413166046143
[INFO 55:23] valid_loss : 1.6753969192504883
[INFO 55:31] - meta_params: 0.00125
[INFO 55:36] rmse : 0.5534452795982361
[INFO 55:36] valid_rmse : 1.349866509437561
[INFO 55:36] valid_loss : 1.6737686395645142
[INFO 55:44] - meta_params: 0.00125
[INFO 55:50] rmse : 0.556702196598053
[INFO 55:50] valid_rmse : 1.3578102588653564
[INFO 55:50] valid_loss : 1.6753226518630981
[INFO 55:57] - meta_params: 0.000625
[INFO 56:03] rmse : 0.5571659207344055
[INFO 56:03] valid_rmse : 1.3589413166046143
[INFO 56:03] valid_loss : 1.6737980842590332
[INFO 56:10] - meta_params: 0.000625
[INFO 56:16] rmse : 0.5529783964157104
[INFO 56:16] valid_rmse : 1.348727822303772
[INFO 56:16] valid_loss : 1.673353910446167
[INFO 56:23] - meta_params: 0.000625
[INFO 56:28] rmse : 0.5562381148338318
[INFO 56:28] valid_rmse : 1.3566783666610718
[INFO 56:28] valid_loss : 1.6719670295715332
[INFO 56:36] - meta_params: 0.0003125
[INFO 56:41] rmse : 0.5585548281669617
[INFO 56:41] valid_rmse : 1.3623288869857788
[INFO 56:41] valid_loss : 1.6768543720245361
[INFO 56:48] - meta_params: 0.0003125
[INFO 56:54] rmse : 0.5548434257507324
[INFO 56:54] valid_rmse : 1.3532767295837402
[INFO 56:54] valid_loss : 1.6767189502716064
[INFO 57:01] - meta_params: 0.0003125
[INFO 57:06] rmse : 0.5557736158370972
[INFO 57:06] valid_rmse : 1.3555454015731812
[INFO 57:06] valid_loss : 1.6725070476531982
[INFO 57:13] - meta_params: 0.00015625
[INFO 57:18] rmse : 0.5539116859436035
[INFO 57:18] valid_rmse : 1.3510041236877441
[INFO 57:18] valid_loss : 1.6732896566390991
[INFO 57:25] - meta_params: 0.00015625
[INFO 57:31] rmse : 0.5580922365188599
[INFO 57:31] valid_rmse : 1.3612005710601807
[INFO 57:31] valid_loss : 1.6738063097000122
[INFO 57:37] - meta_params: 0.00015625
[INFO 57:43] rmse : 0.5557736158370972
[INFO 57:43] valid_rmse : 1.3555454015731812
[INFO 57:43] valid_loss : 1.6732321977615356
[INFO 57:43] -- END Training --
[INFO 57:43] ✅ Entraînement terminé en 360.12 secondes.
[INFO 57:43] train on cuda
[WARNING 57:53] Computing RM on meta and QUERY set
[INFO 57:55] RM: 0.05033867161270439
[WARNING 57:58] Computing RM on meta and QUERY set
[INFO 57:58] RM: 0.05219387481057288
[WARNING 58:01] Computing RM on meta and QUERY set
[INFO 58:01] RM: 0.053556782451780305
[WARNING 58:04] Computing RM on meta and QUERY set
[INFO 58:04] RM: 0.054638219017668396
[WARNING 58:07] Computing RM on meta and QUERY set
[INFO 58:07] RM: 0.056478423420947735
[WARNING 58:09] Computing RM on meta and QUERY set
[INFO 58:09] RM: 0.05828754366337471
[WARNING 58:12] Computing RM on meta and QUERY set
[INFO 58:12] RM: 0.059994473984875896
[WARNING 58:15] Computing RM on meta and QUERY set
[INFO 58:15] RM: 0.061542007664863625
[WARNING 58:18] Computing RM on meta and QUERY set
[INFO 58:18] RM: 0.0640709109833091
[WARNING 58:20] Computing RM on meta and QUERY set
[INFO 58:20] RM: 0.06633822854747395
[WARNING 58:23] Computing RM on meta and QUERY set
[INFO 58:23] RM: 0.06855859911953746
[WARNING 58:26] Computing RM on meta and QUERY set
[INFO 58:26] RM: 0.0707013302560431
[WARNING 58:29] Computing RM on meta and QUERY set
[INFO 58:29] RM: 0.07356312669360451
[WARNING 58:31] Computing RM on meta and QUERY set
[INFO 58:31] RM: 0.0764255100080471
[WARNING 58:34] Computing RM on meta and QUERY set
[INFO 58:34] RM: 0.07911283339075419
[WARNING 58:37] Computing RM on meta and QUERY set
[INFO 58:37] RM: 0.08175581886731809
[INFO 58:37] Fold 3; pareto_index: 5.287232052778351; results: ({0: {'mi_acc': 0.6386163830757141, 'rmse': 0.6011518836021423, 'mae': 0.3613835871219635, 'mi_prec': 0.8308207988739014, 'mi_rec': 0.6657717823982239, 'mi_f_b': 0.7391952872276306, 'mi_auc': 0.6069351230425056, 'ma_prec': 0.5802825689315796, 'ma_rec': 0.6069351434707642, 'ma_f_b': 0.5754799842834473}, 1: {'mi_acc': 0.6381001472473145, 'rmse': 0.6015811562538147, 'mae': 0.36189985275268555, 'mi_prec': 0.8308207988739014, 'mi_rec': 0.6653252840042114, 'mi_f_b': 0.7389199137687683, 'mi_auc': 0.6062052434186584, 'ma_prec': 0.5796095728874207, 'ma_rec': 0.6062052249908447, 'ma_f_b': 0.5746744275093079}, 2: {'mi_acc': 0.6375839114189148, 'rmse': 0.6020100116729736, 'mae': 0.3624160885810852, 'mi_prec': 0.8299832344055176, 'mi_rec': 0.6651006937026978, 'mi_f_b': 0.7384500503540039, 'mi_auc': 0.6054809843400447, 'ma_prec': 0.5791907906532288, 'ma_rec': 0.6054810285568237, 'ma_f_b': 0.5742670297622681}, 3: {'mi_acc': 0.6365513801574707, 'rmse': 0.6028670072555542, 'mae': 0.3634486198425293, 'mi_prec': 0.8291457295417786, 'mi_rec': 0.6644295454025269, 'mi_f_b': 0.737704873085022, 'mi_auc': 0.6040268456375839, 'ma_prec': 0.5780991315841675, 'ma_rec': 0.6040268540382385, 'ma_f_b': 0.5730541348457336}, 4: {'mi_acc': 0.6386163830757141, 'rmse': 0.6011518836021423, 'mae': 0.3613835871219635, 'mi_prec': 0.8274706602096558, 'mi_rec': 0.6666666865348816, 'mi_f_b': 0.7384155988693237, 'mi_auc': 0.6069597069597069, 'ma_prec': 0.5812992453575134, 'ma_rec': 0.6069597005844116, 'ma_f_b': 0.5770542025566101}, 5: {'mi_acc': 0.6391326785087585, 'rmse': 0.6007223129272461, 'mae': 0.36086732149124146, 'mi_prec': 0.8283082246780396, 'mi_rec': 0.6668914556503296, 'mi_f_b': 0.7388867735862732, 'mi_auc': 0.6076747930287754, 'ma_prec': 0.5817180275917053, 'ma_rec': 0.6076748371124268, 'ma_f_b': 0.5774633884429932}, 6: {'mi_acc': 0.6391326785087585, 'rmse': 0.6007223129272461, 'mae': 0.36086732149124146, 'mi_prec': 0.8274706602096558, 'mi_rec': 0.6671168208122253, 'mi_f_b': 0.7386916279792786, 'mi_auc': 0.6076812134996505, 'ma_prec': 0.5819722414016724, 'ma_rec': 0.6076812148094177, 'ma_f_b': 0.5778529047966003}, 7: {'mi_acc': 0.6391326785087585, 'rmse': 0.6007223129272461, 'mae': 0.36086732149124146, 'mi_prec': 0.8274706602096558, 'mi_rec': 0.6671168208122253, 'mi_f_b': 0.7386916279792786, 'mi_auc': 0.6076812134996505, 'ma_prec': 0.5819722414016724, 'ma_rec': 0.6076812148094177, 'ma_f_b': 0.5778529047966003}, 8: {'mi_acc': 0.6375839114189148, 'rmse': 0.6020100116729736, 'mae': 0.3624160885810852, 'mi_prec': 0.8257956504821777, 'mi_rec': 0.6662161946296692, 'mi_f_b': 0.7374719977378845, 'mi_auc': 0.6055369921343663, 'ma_prec': 0.5804617404937744, 'ma_rec': 0.605536937713623, 'ma_f_b': 0.5762360095977783}, 9: {'mi_acc': 0.6370676159858704, 'rmse': 0.6024386882781982, 'mae': 0.36293235421180725, 'mi_prec': 0.8249581456184387, 'mi_rec': 0.6659905314445496, 'mi_f_b': 0.7369996905326843, 'mi_auc': 0.6048293282077174, 'ma_prec': 0.5800430178642273, 'ma_rec': 0.6048293113708496, 'ma_f_b': 0.5758271217346191}, 10: {'mi_acc': 0.6375839114189148, 'rmse': 0.6020100116729736, 'mae': 0.3624160885810852, 'mi_prec': 0.8257956504821777, 'mi_rec': 0.6662161946296692, 'mi_f_b': 0.7374719977378845, 'mi_auc': 0.6055369921343663, 'ma_prec': 0.5804617404937744, 'ma_rec': 0.605536937713623, 'ma_f_b': 0.5762360095977783}, 11: {'mi_acc': 0.6381001472473145, 'rmse': 0.6015811562538147, 'mae': 0.36189985275268555, 'mi_prec': 0.8266331553459167, 'mi_rec': 0.6664416193962097, 'mi_f_b': 0.7379439473152161, 'mi_auc': 0.6062471125484203, 'ma_prec': 0.5808805227279663, 'ma_rec': 0.6062471270561218, 'ma_f_b': 0.576645016670227}, 12: {'mi_acc': 0.6365513801574707, 'rmse': 0.6028670072555542, 'mae': 0.3634486198425293, 'mi_prec': 0.8224455714225769, 'mi_rec': 0.6662144064903259, 'mi_f_b': 0.7361319661140442, 'mi_auc': 0.6041655066509197, 'ma_prec': 0.5801326036453247, 'ma_rec': 0.6041655540466309, 'ma_f_b': 0.5761920213699341}, 13: {'mi_acc': 0.6381001472473145, 'rmse': 0.6015811562538147, 'mae': 0.36189985275268555, 'mi_prec': 0.8224455714225769, 'mi_rec': 0.667573094367981, 'mi_f_b': 0.7369606494903564, 'mi_auc': 0.6063187286100664, 'ma_prec': 0.582151472568512, 'ma_rec': 0.6063187122344971, 'ma_f_b': 0.5785713195800781}, 14: {'mi_acc': 0.6386163830757141, 'rmse': 0.6011518836021423, 'mae': 0.3613835871219635, 'mi_prec': 0.8224455714225769, 'mi_rec': 0.6680272221565247, 'mi_f_b': 0.7372372150421143, 'mi_auc': 0.607032877390785, 'ma_prec': 0.5828244090080261, 'ma_rec': 0.6070328950881958, 'ma_f_b': 0.5793623924255371}, 15: {'mi_acc': 0.6401652097702026, 'rmse': 0.5998623371124268, 'mae': 0.35983479022979736, 'mi_prec': 0.8241205811500549, 'mi_rec': 0.6689326763153076, 'mi_f_b': 0.7384615540504456, 'mi_auc': 0.6091444610101446, 'ma_prec': 0.5843348503112793, 'ma_rec': 0.6091444492340088, 'ma_f_b': 0.5809760093688965}}, {0: {'meta_doa': np.float64(0.514635600280127), 'pc-er': 0.08837890625, 'rm': 0.05033867161270439}, 1: {'meta_doa': np.float64(0.5147954362083336), 'pc-er': 0.08917236328125, 'rm': 0.05219387481057288}, 2: {'meta_doa': np.float64(0.5148574750934891), 'pc-er': 0.09033203125, 'rm': 0.053556782451780305}, 3: {'meta_doa': np.float64(0.5149555831702262), 'pc-er': 0.09136962890625, 'rm': 0.054638219017668396}, 4: {'meta_doa': np.float64(0.5162290021158984), 'pc-er': 0.094482421875, 'rm': 0.056478423420947735}, 5: {'meta_doa': np.float64(0.5165902302826015), 'pc-er': 0.09783935546875, 'rm': 0.05828754366337471}, 6: {'meta_doa': np.float64(0.5169570499895904), 'pc-er': 0.10076904296875, 'rm': 0.059994473984875896}, 7: {'meta_doa': np.float64(0.5172826384412575), 'pc-er': 0.10345458984375, 'rm': 0.061542007664863625}, 8: {'meta_doa': np.float64(0.5180211321296422), 'pc-er': 0.10711669921875, 'rm': 0.0640709109833091}, 9: {'meta_doa': np.float64(0.518368189480803), 'pc-er': 0.11151123046875, 'rm': 0.06633822854747395}, 10: {'meta_doa': np.float64(0.5188471849097348), 'pc-er': 0.11590576171875, 'rm': 0.06855859911953746}, 11: {'meta_doa': np.float64(0.5193895177245427), 'pc-er': 0.120361328125, 'rm': 0.0707013302560431}, 12: {'meta_doa': np.float64(0.5200383035183664), 'pc-er': 0.1275634765625, 'rm': 0.07356312669360451}, 13: {'meta_doa': np.float64(0.5207229489353503), 'pc-er': 0.1334228515625, 'rm': 0.0764255100080471}, 14: {'meta_doa': np.float64(0.5214653785293244), 'pc-er': 0.1392822265625, 'rm': 0.07911283339075419}, 15: {'meta_doa': np.float64(0.5218932153550878), 'pc-er': 0.144287109375, 'rm': 0.08175581886731809}})
