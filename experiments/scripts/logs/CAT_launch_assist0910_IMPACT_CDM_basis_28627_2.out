PID 1462187 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 47:22] Using device: cuda
[INFO 47:22] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 2, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.003, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 47:39] Random_cont_model
[INFO 47:39] compiling CDM model
[INFO 47:43] compiling selection model
[INFO 47:43] ⏳ Début de l'entraînement...
[INFO 47:43] ✅ Entraînement terminé en 0.00 secondes.
[INFO 47:43] train on cuda
Meta_loss tensor(0.6867, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6851, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6836, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6821, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6807, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6793, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6780, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6768, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6756, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6744, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6733, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6722, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6712, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6702, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6692, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6682, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6673, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6664, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6655, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6646, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6638, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6630, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6622, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6614, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6606, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6599, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6591, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6584, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6577, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6570, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6563, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6557, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6550, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6544, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6537, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6531, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6525, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6519, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6513, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6507, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6502, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6496, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6491, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6485, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6480, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6475, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6470, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6465, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6460, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6456, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6451, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6447, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6442, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6438, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6433, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6429, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6425, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6421, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6416, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6413, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6409, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6405, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6402, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6398, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6394, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6391, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6387, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6384, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6381, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6378, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6375, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6372, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6369, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6366, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6363, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6360, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6358, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6355, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6353, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6350, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6347, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6345, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6343, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6340, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6338, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6336, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6333, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6331, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6329, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6327, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6325, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6323, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6321, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6320, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6318, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6316, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6314, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6313, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6311, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6310, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6308, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6307, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6305, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6304, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6303, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6301, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6300, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6299, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6298, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6297, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6295, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6294, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6294, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6293, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6292, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6291, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6290, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6289, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6289, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6288, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6287, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6286, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6285, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6285, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6284, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6284, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6283, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6283, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6282, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6282, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6282, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6280, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6281, device='cuda:0', grad_fn=<DotBackward0>)
Meta_loss tensor(0.6282, device='cuda:0', grad_fn=<DotBackward0>)
---------- best_epoch : 141 ;   
[WARNING 48:23] Computing RM on meta and QUERY set
[INFO 48:25] RM: 0.3743359824765799
[INFO 48:25] Fold 2; results: ({'mi_acc': 0.6834118366241455, 'rmse': 0.5626616477966309, 'mae': 0.3165881633758545, 'mi_prec': 0.8067993521690369, 'mi_rec': 0.7234200835227966, 'mi_f_b': 0.7628381252288818, 'mi_auc': 0.6558796484821416, 'ma_prec': 0.639569878578186, 'ma_rec': 0.6558796167373657, 'ma_f_b': 0.643417477607727}, {'meta_doa': np.float64(0.5740814958181305), 'pc-er': 0.294189453125, 'rm': 0.3743359824765799})
