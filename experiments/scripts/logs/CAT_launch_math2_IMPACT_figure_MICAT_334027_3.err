Loading pytorch-gpu/py3/2.7.0
  Loading requirement: gcc/11.4.1 cuda/12.6.3 nccl/2.25.1-1-cuda
    cudnn/9.5.1.17-cuda openmpi/4.1.6-cuda intel-mkl/2020.4 magma/2.9.0-cuda
    sox/14.4.2 hdf5/1.12.0-mpi-cuda libjpeg-turbo/2.1.3 ffmpeg/6.1.1
    openjdk/11.0.2
Traceback (most recent call last):
  File "/lustre/fsn1/projects/rech/enh/unv34ei/MICAT/experiments/scripts/CAT_launch_figure_MICAT-SLURM.py", line 148, in <module>
    main(args.dataset_name, args.cdm, args.i_fold)
  File "/lustre/fsn1/projects/rech/enh/unv34ei/MICAT/experiments/scripts/CAT_launch_figure_MICAT-SLURM.py", line 96, in main
    train_data = micat.dataset.CATDataset(train_df, concept_map, metadata, config, nb_modalities)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/enh/unv34ei/MICAT/micat/dataset/dataset.py", line 214, in __init__
    Dataset.__init__(self, data, concept_map, metadata, config, nb_modalities)
  File "/lustre/fsn1/projects/rech/enh/unv34ei/MICAT/micat/dataset/dataset.py", line 26, in __init__
    super().__init__(df.to_records(index=False, column_dtypes={'user_id': int, 'item_id': int, "dimension_id": int,
  File "/lustre/fsn1/projects/rech/enh/unv34ei/IMPACT/IMPACT/dataset/dataset.py", line 23, in __init__
    self._raw_data_array = self._generate_raw_data_array()  # precompute right away
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/enh/unv34ei/IMPACT/IMPACT/dataset/dataset.py", line 153, in _generate_raw_data_array
    tensor_data = tensor_data.to(device)
                  ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

srun: error: r3i6n3: task 0: Exited with exit code 1
srun: Terminating StepId=334035.0
