PID 2029287 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 58:21] Using device: cuda
[INFO 58:21] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'ncdm', 'i_fold': 4, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.001, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 58:39] Random_cont_model
../ckpt/assist0910_NCDM_fold_4_seed_0
[INFO 58:42] compiling selection model
[INFO 58:50] ⏳ Début de l'entraînement...
[INFO 58:50] ✅ Entraînement terminé en 0.00 secondes.
[INFO 58:50] train on cuda
Meta_loss tensor(0.9814, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9751, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9688, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9622, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9549, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9474, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9398, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9327, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9262, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9206, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9157, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9114, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9076, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9037, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8999, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8962, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8930, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8903, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8874, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8845, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8818, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8793, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8772, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8753, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8734, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8712, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8687, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8661, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8639, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8619, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8598, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8581, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8564, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8546, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8527, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8509, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8495, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8484, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8474, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8468, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8461, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8458, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8453, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8447, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8439, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8432, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8426, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8419, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8413, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8406, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8398, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8392, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8386, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8381, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8377, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8372, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8368, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8363, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8356, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8348, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8336, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8325, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8317, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8309, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8302, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8296, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8288, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8275, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8264, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8256, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8249, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8241, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8235, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8230, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8225, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8220, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8217, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8214, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8210, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8206, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8200, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8193, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8186, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8182, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8176, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8174, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8172, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8169, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8166, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8164, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8161, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8158, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8155, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8151, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8146, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8145, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8144, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8145, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8144, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8141, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8140, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8135, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8127, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8118, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8109, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8102, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8097, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8093, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8090, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8088, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8083, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8079, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8077, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8076, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8075, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8075, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8075, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8074, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8073, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8071, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8065, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8059, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8051, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8045, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8040, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8037, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8034, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8029, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8023, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8020, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8018, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8013, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8006, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8002, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8000, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7999, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7998, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7995, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7993, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7988, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7983, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7979, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7976, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7974, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7971, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7972, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7973, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7975, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7976, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7974, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7971, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7966, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7961, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7958, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7956, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7955, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7956, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7955, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7957, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7959, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7960, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7961, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7964, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7964, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7961, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7961, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7962, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7967, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.7970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
---------- best_epoch : 159 ;   
[WARNING 59:34] Computing RM on meta and QUERY set
[INFO 59:37] RM: 0.030045340427565022
[INFO 59:37] Fold 4; results: ({'mi_acc': 0.6487603187561035, 'rmse': 0.5051918625831604, 'mae': 0.38241952657699585, 'mi_prec': 0.7574999928474426, 'mi_rec': 0.7003081440925598, 'mi_f_b': 0.7277822494506836, 'mi_auc': nan, 'ma_prec': 0.6144837141036987, 'ma_rec': 0.6220976114273071, 'ma_f_b': 0.6164384484291077}, {'meta_doa': np.float64(0.5014657198091413), 'pc-er': -0.039764404296875, 'rm': 0.030045340427565022})
