PID 2849083 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 51:17] Using device: cuda
[INFO 51:17] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 2, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0030272604785952922, 'meta_lr': 0.01, 'meta_trainer': 'Approx_GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 51:35] Random_cont_model
[INFO 51:35] compiling CDM model
[INFO 51:43] compiling selection model
[INFO 51:43] ⏳ Début de l'entraînement...
[INFO 51:43] ------- START Training
[INFO 51:43] train on cuda
[INFO 52:02] - meta_params: 0.01
[INFO 52:09] rmse : 0.5625555515289307
[INFO 52:09] valid_rmse : 1.372086763381958
[INFO 52:09] valid_loss : 1.6950149536132812
[INFO 52:22] - meta_params: 0.01
[INFO 52:27] rmse : 0.5602566003799438
[INFO 52:27] valid_rmse : 1.366479516029358
[INFO 52:27] valid_loss : 1.6931889057159424
[INFO 52:39] - meta_params: 0.01
[INFO 52:45] rmse : 0.5593343377113342
[INFO 52:45] valid_rmse : 1.3642301559448242
[INFO 52:45] valid_loss : 1.694416880607605
[INFO 52:55] - meta_params: 0.01
[INFO 53:01] rmse : 0.5593343377113342
[INFO 53:01] valid_rmse : 1.3642301559448242
[INFO 53:01] valid_loss : 1.6959248781204224
[INFO 53:11] - meta_params: 0.01
[INFO 53:17] rmse : 0.5616371035575867
[INFO 53:17] valid_rmse : 1.3698465824127197
[INFO 53:17] valid_loss : 1.6921672821044922
[INFO 53:27] - meta_params: 0.01
[INFO 53:32] rmse : 0.5584105849266052
[INFO 53:32] valid_rmse : 1.3619771003723145
[INFO 53:32] valid_loss : 1.6944876909255981
[INFO 53:42] - meta_params: 0.01
[INFO 53:48] rmse : 0.558872640132904
[INFO 53:48] valid_rmse : 1.363103985786438
[INFO 53:48] valid_loss : 1.690598964691162
[INFO 53:57] - meta_params: 0.01
[INFO 54:02] rmse : 0.5602566003799438
[INFO 54:02] valid_rmse : 1.366479516029358
[INFO 54:02] valid_loss : 1.6938905715942383
[INFO 54:11] - meta_params: 0.01
[INFO 54:17] rmse : 0.558872640132904
[INFO 54:17] valid_rmse : 1.363103985786438
[INFO 54:17] valid_loss : 1.691474437713623
[INFO 54:26] - meta_params: 0.01
[INFO 54:31] rmse : 0.5584105849266052
[INFO 54:31] valid_rmse : 1.3619771003723145
[INFO 54:31] valid_loss : 1.6932694911956787
[INFO 54:40] - meta_params: 0.005
[INFO 54:45] rmse : 0.5620965361595154
[INFO 54:45] valid_rmse : 1.370967149734497
[INFO 54:45] valid_loss : 1.6942863464355469
[INFO 54:54] - meta_params: 0.005
[INFO 54:59] rmse : 0.5560944676399231
[INFO 54:59] valid_rmse : 1.356328010559082
[INFO 54:59] valid_loss : 1.6921306848526
[INFO 55:08] - meta_params: 0.005
[INFO 55:13] rmse : 0.555630087852478
[INFO 55:13] valid_rmse : 1.35519540309906
[INFO 55:13] valid_loss : 1.6925733089447021
[INFO 55:21] - meta_params: 0.0025
[INFO 55:26] rmse : 0.5579481720924377
[INFO 55:26] valid_rmse : 1.3608492612838745
[INFO 55:26] valid_loss : 1.692960262298584
[INFO 55:34] - meta_params: 0.0025
[INFO 55:40] rmse : 0.5570220947265625
[INFO 55:40] valid_rmse : 1.3585904836654663
[INFO 55:40] valid_loss : 1.6930032968521118
[INFO 55:47] - meta_params: 0.0025
[INFO 55:53] rmse : 0.5579481720924377
[INFO 55:53] valid_rmse : 1.3608492612838745
[INFO 55:53] valid_loss : 1.6941931247711182
[INFO 56:01] - meta_params: 0.00125
[INFO 56:06] rmse : 0.5611773133277893
[INFO 56:06] valid_rmse : 1.3687251806259155
[INFO 56:06] valid_loss : 1.6956968307495117
[INFO 56:13] - meta_params: 0.00125
[INFO 56:19] rmse : 0.5611773133277893
[INFO 56:19] valid_rmse : 1.3687251806259155
[INFO 56:19] valid_loss : 1.695378303527832
[INFO 56:26] - meta_params: 0.00125
[INFO 56:32] rmse : 0.5625555515289307
[INFO 56:32] valid_rmse : 1.372086763381958
[INFO 56:32] valid_loss : 1.696195125579834
[INFO 56:39] - meta_params: 0.000625
[INFO 56:45] rmse : 0.558872640132904
[INFO 56:45] valid_rmse : 1.363103985786438
[INFO 56:45] valid_loss : 1.6974948644638062
[INFO 56:52] - meta_params: 0.000625
[INFO 56:57] rmse : 0.5574853420257568
[INFO 56:57] valid_rmse : 1.3597203493118286
[INFO 56:57] valid_loss : 1.6938426494598389
[INFO 57:04] - meta_params: 0.000625
[INFO 57:10] rmse : 0.5551653504371643
[INFO 57:10] valid_rmse : 1.3540618419647217
[INFO 57:10] valid_loss : 1.6914907693862915
[INFO 57:17] - meta_params: 0.0003125
[INFO 57:22] rmse : 0.5616371035575867
[INFO 57:22] valid_rmse : 1.3698465824127197
[INFO 57:22] valid_loss : 1.691024899482727
[INFO 57:29] - meta_params: 0.0003125
[INFO 57:35] rmse : 0.5630142092704773
[INFO 57:35] valid_rmse : 1.3732054233551025
[INFO 57:35] valid_loss : 1.6916371583938599
[INFO 57:41] - meta_params: 0.0003125
[INFO 57:47] rmse : 0.5584105849266052
[INFO 57:47] valid_rmse : 1.3619771003723145
[INFO 57:47] valid_loss : 1.6914705038070679
[INFO 57:54] - meta_params: 0.00015625
[INFO 57:59] rmse : 0.5570220947265625
[INFO 57:59] valid_rmse : 1.3585904836654663
[INFO 57:59] valid_loss : 1.6905049085617065
[INFO 58:06] - meta_params: 0.00015625
[INFO 58:11] rmse : 0.5616371035575867
[INFO 58:11] valid_rmse : 1.3698465824127197
[INFO 58:11] valid_loss : 1.6952989101409912
[INFO 58:18] - meta_params: 0.00015625
[INFO 58:24] rmse : 0.5602566003799438
[INFO 58:24] valid_rmse : 1.366479516029358
[INFO 58:24] valid_loss : 1.6940650939941406
[INFO 58:24] -- END Training --
[INFO 58:24] ✅ Entraînement terminé en 401.11 secondes.
[INFO 58:24] train on cuda
[WARNING 58:33] Computing RM on meta and QUERY set
[INFO 58:36] RM: -0.028621086971696373
[WARNING 58:39] Computing RM on meta and QUERY set
[INFO 58:39] RM: -0.028048665872577393
[WARNING 58:41] Computing RM on meta and QUERY set
[INFO 58:41] RM: -0.02747671003739416
[WARNING 58:44] Computing RM on meta and QUERY set
[INFO 58:44] RM: -0.026900868330713115
[WARNING 58:47] Computing RM on meta and QUERY set
[INFO 58:47] RM: -0.025795234860779313
[WARNING 58:50] Computing RM on meta and QUERY set
[INFO 58:50] RM: -0.024741855220956156
[WARNING 58:52] Computing RM on meta and QUERY set
[INFO 58:52] RM: -0.023664841732913226
[WARNING 58:55] Computing RM on meta and QUERY set
[INFO 58:55] RM: -0.02258845610827934
[WARNING 58:58] Computing RM on meta and QUERY set
[INFO 58:58] RM: -0.020923686557567933
[WARNING 59:00] Computing RM on meta and QUERY set
[INFO 59:00] RM: -0.01924179626918
[WARNING 59:03] Computing RM on meta and QUERY set
[INFO 59:03] RM: -0.017565754822387467
[WARNING 59:06] Computing RM on meta and QUERY set
[INFO 59:06] RM: -0.015935245036633208
[WARNING 59:09] Computing RM on meta and QUERY set
[INFO 59:09] RM: -0.013688454490010424
[WARNING 59:12] Computing RM on meta and QUERY set
[INFO 59:12] RM: -0.011662616433891963
[WARNING 59:14] Computing RM on meta and QUERY set
[INFO 59:14] RM: -0.009558869475927979
[WARNING 59:17] Computing RM on meta and QUERY set
[INFO 59:17] RM: -0.007465181251415321
[INFO 59:17] Fold 2; pareto_index: 4.871640388257311; results: ({0: {'mi_acc': 0.6394557952880859, 'rmse': 0.6004533171653748, 'mae': 0.36054420471191406, 'mi_prec': 0.7927031517028809, 'mi_rec': 0.6853046417236328, 'mi_f_b': 0.7351018786430359, 'mi_auc': 0.6004042677336001, 'ma_prec': 0.5850040912628174, 'ma_rec': 0.6004042625427246, 'ma_f_b': 0.585405170917511}, 1: {'mi_acc': 0.6399790644645691, 'rmse': 0.6000174283981323, 'mae': 0.3600209355354309, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6855300664901733, 'mi_f_b': 0.735588014125824, 'mi_auc': 0.6010174701644088, 'ma_prec': 0.5854186415672302, 'ma_rec': 0.6010174751281738, 'ma_f_b': 0.5858268141746521}, 2: {'mi_acc': 0.6399790644645691, 'rmse': 0.6000174283981323, 'mae': 0.3600209355354309, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6855300664901733, 'mi_f_b': 0.735588014125824, 'mi_auc': 0.6010174701644088, 'ma_prec': 0.5854186415672302, 'ma_rec': 0.6010174751281738, 'ma_f_b': 0.5858268141746521}, 3: {'mi_acc': 0.6399790644645691, 'rmse': 0.6000174283981323, 'mae': 0.3600209355354309, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6855300664901733, 'mi_f_b': 0.735588014125824, 'mi_auc': 0.6010174701644088, 'ma_prec': 0.5854186415672302, 'ma_rec': 0.6010174751281738, 'ma_f_b': 0.5858268141746521}, 4: {'mi_acc': 0.6420722007751465, 'rmse': 0.5982706546783447, 'mae': 0.35792776942253113, 'mi_prec': 0.795190691947937, 'mi_rec': 0.6869627237319946, 'mi_f_b': 0.7371252775192261, 'mi_auc': 0.6036755501154478, 'ma_prec': 0.5876662731170654, 'ma_rec': 0.6036755442619324, 'ma_f_b': 0.5882347822189331}, 5: {'mi_acc': 0.6415489315986633, 'rmse': 0.5987078547477722, 'mae': 0.35845106840133667, 'mi_prec': 0.7943615317344666, 'mi_rec': 0.6867383718490601, 'mi_f_b': 0.7366397380828857, 'mi_auc': 0.6030590981078603, 'ma_prec': 0.5872516632080078, 'ma_rec': 0.6030591130256653, 'ma_f_b': 0.587812066078186}, 6: {'mi_acc': 0.6405023336410522, 'rmse': 0.599581241607666, 'mae': 0.35949763655662537, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6860215067863464, 'mi_f_b': 0.7358708381652832, 'mi_auc': 0.6017316829207302, 'ma_prec': 0.5861278772354126, 'ma_rec': 0.6017316579818726, 'ma_f_b': 0.5866086483001709}, 7: {'mi_acc': 0.6420722007751465, 'rmse': 0.5982706546783447, 'mae': 0.35792776942253113, 'mi_prec': 0.7943615317344666, 'mi_rec': 0.6872310042381287, 'mi_f_b': 0.736923098564148, 'mi_auc': 0.6037702338566223, 'ma_prec': 0.5879608988761902, 'ma_rec': 0.6037702560424805, 'ma_f_b': 0.5885924696922302}, 8: {'mi_acc': 0.6420722007751465, 'rmse': 0.5982706546783447, 'mae': 0.35792776942253113, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6875, 'mi_f_b': 0.7367205023765564, 'mi_auc': 0.6038656069364162, 'ma_prec': 0.5882555246353149, 'ma_rec': 0.6038656234741211, 'ma_f_b': 0.5889484882354736}, 9: {'mi_acc': 0.6425954699516296, 'rmse': 0.5978331565856934, 'mae': 0.357404500246048, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6879942417144775, 'mi_f_b': 0.7370041608810425, 'mi_auc': 0.6045740474478791, 'ma_prec': 0.5889647006988525, 'ma_rec': 0.6045740842819214, 'ma_f_b': 0.5897265672683716}, 10: {'mi_acc': 0.6436420679092407, 'rmse': 0.5969572067260742, 'mae': 0.3563579320907593, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6889848709106445, 'mi_f_b': 0.7375722527503967, 'mi_auc': 0.6059866934783148, 'ma_prec': 0.5903831720352173, 'ma_rec': 0.6059867143630981, 'ma_f_b': 0.5912799835205078}, 11: {'mi_acc': 0.6436420679092407, 'rmse': 0.5969572067260742, 'mae': 0.3563579320907593, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6889848709106445, 'mi_f_b': 0.7375722527503967, 'mi_auc': 0.6059866934783148, 'ma_prec': 0.5903831720352173, 'ma_rec': 0.6059867143630981, 'ma_f_b': 0.5912799835205078}, 12: {'mi_acc': 0.6441653370857239, 'rmse': 0.5965187549591064, 'mae': 0.35583463311195374, 'mi_prec': 0.7943615317344666, 'mi_rec': 0.6892086267471313, 'mi_f_b': 0.7380585670471191, 'mi_auc': 0.6066004777751695, 'ma_prec': 0.5907977819442749, 'ma_rec': 0.6066004633903503, 'ma_f_b': 0.5917046070098877}, 13: {'mi_acc': 0.6431187987327576, 'rmse': 0.5973953604698181, 'mae': 0.35688120126724243, 'mi_prec': 0.7935323119163513, 'mi_rec': 0.6884891986846924, 'mi_f_b': 0.7372881174087524, 'mi_auc': 0.6052810726466812, 'ma_prec': 0.5896739363670349, 'ma_rec': 0.6052810549736023, 'ma_f_b': 0.5905037522315979}, 14: {'mi_acc': 0.6457352042198181, 'rmse': 0.5952014327049255, 'mae': 0.3542647659778595, 'mi_prec': 0.7943615317344666, 'mi_rec': 0.6906993389129639, 'mi_f_b': 0.7389124035835266, 'mi_auc': 0.6087084541847141, 'ma_prec': 0.5929254293441772, 'ma_rec': 0.6087084412574768, 'ma_f_b': 0.5940290093421936}, 15: {'mi_acc': 0.6446886658668518, 'rmse': 0.5960800051689148, 'mae': 0.3553113639354706, 'mi_prec': 0.7927031517028809, 'mi_rec': 0.6902527213096619, 'mi_f_b': 0.7379390001296997, 'mi_auc': 0.607483768239283, 'ma_prec': 0.5920962691307068, 'ma_rec': 0.6074837446212769, 'ma_f_b': 0.5931774377822876}}, {0: {'meta_doa': np.float64(0.471941619337018), 'pc-er': -0.053985595703125, 'rm': -0.028621086971696373}, 1: {'meta_doa': np.float64(0.4722954120783429), 'pc-er': -0.052490234375, 'rm': -0.028048665872577393}, 2: {'meta_doa': np.float64(0.4726508005232473), 'pc-er': -0.050872802734375, 'rm': -0.02747671003739416}, 3: {'meta_doa': np.float64(0.4727480913875887), 'pc-er': -0.049713134765625, 'rm': -0.026900868330713115}, 4: {'meta_doa': np.float64(0.47293803759401704), 'pc-er': -0.047332763671875, 'rm': -0.025795234860779313}, 5: {'meta_doa': np.float64(0.4731680488586126), 'pc-er': -0.044952392578125, 'rm': -0.024741855220956156}, 6: {'meta_doa': np.float64(0.4733872511846408), 'pc-er': -0.04278564453125, 'rm': -0.023664841732913226}, 7: {'meta_doa': np.float64(0.4733583914678662), 'pc-er': -0.040618896484375, 'rm': -0.02258845610827934}, 8: {'meta_doa': np.float64(0.47363028324442), 'pc-er': -0.03790283203125, 'rm': -0.020923686557567933}, 9: {'meta_doa': np.float64(0.47386507684583196), 'pc-er': -0.034149169921875, 'rm': -0.01924179626918}, 10: {'meta_doa': np.float64(0.474276270239659), 'pc-er': 0.00853729248046875, 'rm': -0.017565754822387467}, 11: {'meta_doa': np.float64(0.4748429021552099), 'pc-er': 0.01152801513671875, 'rm': -0.015935245036633208}, 12: {'meta_doa': np.float64(0.4757455932788005), 'pc-er': 0.016937255859375, 'rm': -0.013688454490010424}, 13: {'meta_doa': np.float64(0.4764367502036849), 'pc-er': 0.0204620361328125, 'rm': -0.011662616433891963}, 14: {'meta_doa': np.float64(0.4768051793502761), 'pc-er': 0.02386474609375, 'rm': -0.009558869475927979}, 15: {'meta_doa': np.float64(0.47766874602631954), 'pc-er': 0.0271453857421875, 'rm': -0.007465181251415321}})
