PID 133729 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 51:17] Using device: cuda
[INFO 51:17] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 4, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0030272604785952922, 'meta_lr': 0.01, 'meta_trainer': 'Approx_GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 51:34] Random_cont_model
[INFO 51:35] compiling CDM model
[INFO 51:43] compiling selection model
[INFO 51:43] ⏳ Début de l'entraînement...
[INFO 51:43] ------- START Training
[INFO 51:43] train on cuda
[INFO 52:02] - meta_params: 0.01
[INFO 52:09] rmse : 0.5930091142654419
[INFO 52:09] valid_rmse : 1.4463636875152588
[INFO 52:09] valid_loss : 1.7114471197128296
[INFO 52:22] - meta_params: 0.01
[INFO 52:27] rmse : 0.5960624814033508
[INFO 52:27] valid_rmse : 1.4538109302520752
[INFO 52:27] valid_loss : 1.7052924633026123
[INFO 52:39] - meta_params: 0.01
[INFO 52:44] rmse : 0.5925716161727905
[INFO 52:44] valid_rmse : 1.4452966451644897
[INFO 52:44] valid_loss : 1.7049719095230103
[INFO 52:55] - meta_params: 0.01
[INFO 53:00] rmse : 0.5938830971717834
[INFO 53:00] valid_rmse : 1.4484953880310059
[INFO 53:00] valid_loss : 1.7051151990890503
[INFO 53:11] - meta_params: 0.01
[INFO 53:16] rmse : 0.5930091142654419
[INFO 53:16] valid_rmse : 1.4463636875152588
[INFO 53:16] valid_loss : 1.7044832706451416
[INFO 53:26] - meta_params: 0.01
[INFO 53:31] rmse : 0.5921337604522705
[INFO 53:31] valid_rmse : 1.4442287683486938
[INFO 53:31] valid_loss : 1.7024149894714355
[INFO 53:41] - meta_params: 0.01
[INFO 53:46] rmse : 0.5934462547302246
[INFO 53:46] valid_rmse : 1.447429895401001
[INFO 53:46] valid_loss : 1.7031980752944946
[INFO 53:56] - meta_params: 0.01
[INFO 54:01] rmse : 0.5916956663131714
[INFO 54:01] valid_rmse : 1.4431601762771606
[INFO 54:01] valid_loss : 1.704734444618225
[INFO 54:10] - meta_params: 0.01
[INFO 54:16] rmse : 0.5951916575431824
[INFO 54:16] valid_rmse : 1.451686978340149
[INFO 54:16] valid_loss : 1.7067623138427734
[INFO 54:25] - meta_params: 0.005
[INFO 54:30] rmse : 0.5934462547302246
[INFO 54:30] valid_rmse : 1.447429895401001
[INFO 54:30] valid_loss : 1.7042932510375977
[INFO 54:39] - meta_params: 0.005
[INFO 54:45] rmse : 0.5951916575431824
[INFO 54:45] valid_rmse : 1.451686978340149
[INFO 54:45] valid_loss : 1.7057617902755737
[INFO 54:53] - meta_params: 0.005
[INFO 54:59] rmse : 0.5947558283805847
[INFO 54:59] valid_rmse : 1.4506239891052246
[INFO 54:59] valid_loss : 1.7068235874176025
[INFO 55:07] - meta_params: 0.0025
[INFO 55:13] rmse : 0.5947558283805847
[INFO 55:13] valid_rmse : 1.4506239891052246
[INFO 55:13] valid_loss : 1.7012720108032227
[INFO 55:20] - meta_params: 0.0025
[INFO 55:26] rmse : 0.5943195819854736
[INFO 55:26] valid_rmse : 1.4495600461959839
[INFO 55:26] valid_loss : 1.7069107294082642
[INFO 55:34] - meta_params: 0.0025
[INFO 55:39] rmse : 0.5947558283805847
[INFO 55:39] valid_rmse : 1.4506239891052246
[INFO 55:39] valid_loss : 1.7079240083694458
[INFO 55:47] - meta_params: 0.0025
[INFO 55:53] rmse : 0.5964974164962769
[INFO 55:53] valid_rmse : 1.4548717737197876
[INFO 55:53] valid_loss : 1.7092173099517822
[INFO 56:01] - meta_params: 0.00125
[INFO 56:06] rmse : 0.5973662734031677
[INFO 56:06] valid_rmse : 1.4569909572601318
[INFO 56:06] valid_loss : 1.7030919790267944
[INFO 56:14] - meta_params: 0.00125
[INFO 56:20] rmse : 0.5943195819854736
[INFO 56:20] valid_rmse : 1.4495600461959839
[INFO 56:20] valid_loss : 1.7033838033676147
[INFO 56:27] - meta_params: 0.00125
[INFO 56:32] rmse : 0.5951916575431824
[INFO 56:32] valid_rmse : 1.451686978340149
[INFO 56:32] valid_loss : 1.7076278924942017
[INFO 56:40] - meta_params: 0.000625
[INFO 56:45] rmse : 0.5921337604522705
[INFO 56:45] valid_rmse : 1.4442287683486938
[INFO 56:45] valid_loss : 1.7041218280792236
[INFO 56:53] - meta_params: 0.000625
[INFO 56:58] rmse : 0.5934462547302246
[INFO 56:58] valid_rmse : 1.447429895401001
[INFO 56:58] valid_loss : 1.7061915397644043
[INFO 57:05] - meta_params: 0.000625
[INFO 57:11] rmse : 0.5951916575431824
[INFO 57:11] valid_rmse : 1.451686978340149
[INFO 57:11] valid_loss : 1.7088993787765503
[INFO 57:18] - meta_params: 0.0003125
[INFO 57:24] rmse : 0.5934462547302246
[INFO 57:24] valid_rmse : 1.447429895401001
[INFO 57:24] valid_loss : 1.7049560546875
[INFO 57:31] - meta_params: 0.0003125
[INFO 57:36] rmse : 0.5916956663131714
[INFO 57:36] valid_rmse : 1.4431601762771606
[INFO 57:36] valid_loss : 1.703685998916626
[INFO 57:43] - meta_params: 0.0003125
[INFO 57:49] rmse : 0.5934462547302246
[INFO 57:49] valid_rmse : 1.447429895401001
[INFO 57:49] valid_loss : 1.7034132480621338
[INFO 57:56] - meta_params: 0.00015625
[INFO 58:02] rmse : 0.5991002917289734
[INFO 58:02] valid_rmse : 1.4612202644348145
[INFO 58:02] valid_loss : 1.7058086395263672
[INFO 58:08] - meta_params: 0.00015625
[INFO 58:14] rmse : 0.5868546366691589
[INFO 58:14] valid_rmse : 1.4313528537750244
[INFO 58:14] valid_loss : 1.705133318901062
[INFO 58:21] - meta_params: 0.00015625
[INFO 58:26] rmse : 0.5986672639846802
[INFO 58:26] valid_rmse : 1.4601640701293945
[INFO 58:26] valid_loss : 1.7058236598968506
[INFO 58:26] -- END Training --
[INFO 58:26] ✅ Entraînement terminé en 403.06 secondes.
[INFO 58:26] train on cuda
[WARNING 58:37] Computing RM on meta and QUERY set
[INFO 58:40] RM: 0.022980124078431936
[WARNING 58:42] Computing RM on meta and QUERY set
[INFO 58:42] RM: 0.023681290973545474
[WARNING 58:45] Computing RM on meta and QUERY set
[INFO 58:45] RM: 0.024400209262828206
[WARNING 58:48] Computing RM on meta and QUERY set
[INFO 58:48] RM: 0.025096676817525792
[WARNING 58:51] Computing RM on meta and QUERY set
[INFO 58:51] RM: 0.02644373018219146
[WARNING 58:53] Computing RM on meta and QUERY set
[INFO 58:53] RM: 0.02781219882967983
[WARNING 58:56] Computing RM on meta and QUERY set
[INFO 58:56] RM: 0.029214933724978822
[WARNING 58:59] Computing RM on meta and QUERY set
[INFO 58:59] RM: 0.030580703739764747
[WARNING 59:02] Computing RM on meta and QUERY set
[INFO 59:02] RM: 0.03258737946166346
[WARNING 59:04] Computing RM on meta and QUERY set
[INFO 59:04] RM: 0.034630252102898995
[WARNING 59:07] Computing RM on meta and QUERY set
[INFO 59:07] RM: 0.03660694834531372
[WARNING 59:10] Computing RM on meta and QUERY set
[INFO 59:10] RM: 0.03863646222808422
[WARNING 59:13] Computing RM on meta and QUERY set
[INFO 59:13] RM: 0.04130159551111405
[WARNING 59:15] Computing RM on meta and QUERY set
[INFO 59:15] RM: 0.04402200203698334
[WARNING 59:18] Computing RM on meta and QUERY set
[INFO 59:18] RM: 0.04667924016032226
[WARNING 59:21] Computing RM on meta and QUERY set
[INFO 59:21] RM: 0.04928895190428508
[INFO 59:21] Fold 4; pareto_index: 5.122885152334329; results: ({0: {'mi_acc': 0.6198346614837646, 'rmse': 0.6165754199028015, 'mae': 0.3801652789115906, 'mi_prec': 0.7950000166893005, 'mi_rec': 0.6606647968292236, 'mi_f_b': 0.721633791923523, 'mi_auc': 0.5803324099722992, 'ma_prec': 0.5646195411682129, 'ma_rec': 0.5803323984146118, 'ma_f_b': 0.56114262342453}, 1: {'mi_acc': 0.6203511953353882, 'rmse': 0.6161563992500305, 'mae': 0.37964874505996704, 'mi_prec': 0.7958333492279053, 'mi_rec': 0.6608996391296387, 'mi_f_b': 0.7221172451972961, 'mi_auc': 0.5809589919590694, 'ma_prec': 0.5650362372398376, 'ma_rec': 0.5809589624404907, 'ma_f_b': 0.5615476369857788}, 2: {'mi_acc': 0.6198346614837646, 'rmse': 0.6165754199028015, 'mae': 0.3801652789115906, 'mi_prec': 0.7950000166893005, 'mi_rec': 0.6606647968292236, 'mi_f_b': 0.721633791923523, 'mi_auc': 0.5803324099722992, 'ma_prec': 0.5646195411682129, 'ma_rec': 0.5803323984146118, 'ma_f_b': 0.56114262342453}, 3: {'mi_acc': 0.6188016533851624, 'rmse': 0.6174126267433167, 'mae': 0.38119831681251526, 'mi_prec': 0.7933333516120911, 'mi_rec': 0.6601941585540771, 'mi_f_b': 0.720666229724884, 'mi_auc': 0.579084941629653, 'ma_prec': 0.5637862682342529, 'ma_rec': 0.5790849328041077, 'ma_f_b': 0.5603331327438354}, 4: {'mi_acc': 0.6172520518302917, 'rmse': 0.6186662316322327, 'mae': 0.38274791836738586, 'mi_prec': 0.7908333539962769, 'mi_rec': 0.6594857573509216, 'mi_f_b': 0.7192118763923645, 'mi_auc': 0.5772277864546556, 'ma_prec': 0.5625362396240234, 'ma_rec': 0.577227771282196, 'ma_f_b': 0.5591193437576294}, 5: {'mi_acc': 0.6167355179786682, 'rmse': 0.61908358335495, 'mae': 0.3832644522190094, 'mi_prec': 0.7908333539962769, 'mi_rec': 0.6590277552604675, 'mi_f_b': 0.7189393639564514, 'mi_auc': 0.5764896953405018, 'ma_prec': 0.5618568658828735, 'ma_rec': 0.5764896869659424, 'ma_f_b': 0.5583333373069763}, 6: {'mi_acc': 0.6172520518302917, 'rmse': 0.6186662316322327, 'mae': 0.38274791836738586, 'mi_prec': 0.7908333539962769, 'mi_rec': 0.6594857573509216, 'mi_f_b': 0.7192118763923645, 'mi_auc': 0.5772277864546556, 'ma_prec': 0.5625362396240234, 'ma_rec': 0.577227771282196, 'ma_f_b': 0.5591193437576294}, 7: {'mi_acc': 0.6167355179786682, 'rmse': 0.61908358335495, 'mae': 0.3832644522190094, 'mi_prec': 0.7908333539962769, 'mi_rec': 0.6590277552604675, 'mi_f_b': 0.7189393639564514, 'mi_auc': 0.5764896953405018, 'ma_prec': 0.5618568658828735, 'ma_rec': 0.5764896869659424, 'ma_f_b': 0.5583333373069763}, 8: {'mi_acc': 0.6177685856819153, 'rmse': 0.6182486414909363, 'mae': 0.38223138451576233, 'mi_prec': 0.7908333539962769, 'mi_rec': 0.6599443554878235, 'mi_f_b': 0.7194844484329224, 'mi_auc': 0.5779641514598031, 'ma_prec': 0.5632156133651733, 'ma_rec': 0.5779641270637512, 'ma_f_b': 0.5599043369293213}, 9: {'mi_acc': 0.6219007968902588, 'rmse': 0.6148976683616638, 'mae': 0.37809914350509644, 'mi_prec': 0.7950000166893005, 'mi_rec': 0.6625000238418579, 'mi_f_b': 0.7227272987365723, 'mi_auc': 0.583266129032258, 'ma_prec': 0.5673369765281677, 'ma_rec': 0.5832661390304565, 'ma_f_b': 0.5642857551574707}, 10: {'mi_acc': 0.6224173307418823, 'rmse': 0.6144775152206421, 'mae': 0.3775826394557953, 'mi_prec': 0.7958333492279053, 'mi_rec': 0.6627342104911804, 'mi_f_b': 0.7232109308242798, 'mi_auc': 0.5838923587015189, 'ma_prec': 0.5677536129951477, 'ma_rec': 0.5838923454284668, 'ma_f_b': 0.5646923780441284}, 11: {'mi_acc': 0.6229338645935059, 'rmse': 0.6140570640563965, 'mae': 0.37706610560417175, 'mi_prec': 0.79666668176651, 'mi_rec': 0.662968099117279, 'mi_f_b': 0.7236942052841187, 'mi_auc': 0.5845204871776155, 'ma_prec': 0.5681703090667725, 'ma_rec': 0.5845204591751099, 'ma_f_b': 0.5650991201400757}, 12: {'mi_acc': 0.625, 'rmse': 0.6123723983764648, 'mae': 0.3749999701976776, 'mi_prec': 0.79666668176651, 'mi_rec': 0.6648122668266296, 'mi_f_b': 0.7247915267944336, 'mi_auc': 0.5874261999318554, 'ma_prec': 0.5708876848220825, 'ma_rec': 0.5874261856079102, 'ma_f_b': 0.5682304501533508}, 13: {'mi_acc': 0.6244834661483765, 'rmse': 0.612794041633606, 'mae': 0.37551650404930115, 'mi_prec': 0.7958333492279053, 'mi_rec': 0.6645789742469788, 'mi_f_b': 0.7243079543113708, 'mi_auc': 0.5867985100332886, 'ma_prec': 0.5704710483551025, 'ma_rec': 0.5867985486984253, 'ma_f_b': 0.5678219795227051}, 14: {'mi_acc': 0.6239669322967529, 'rmse': 0.6132153272628784, 'mae': 0.3760330379009247, 'mi_prec': 0.7950000166893005, 'mi_rec': 0.664345383644104, 'mi_f_b': 0.7238240242004395, 'mi_auc': 0.5861727019498607, 'ma_prec': 0.5700543522834778, 'ma_rec': 0.5861726999282837, 'ma_f_b': 0.5674136281013489}, 15: {'mi_acc': 0.6239669322967529, 'rmse': 0.6132153272628784, 'mae': 0.3760330379009247, 'mi_prec': 0.7950000166893005, 'mi_rec': 0.664345383644104, 'mi_f_b': 0.7238240242004395, 'mi_auc': 0.5861727019498607, 'ma_prec': 0.5700543522834778, 'ma_rec': 0.5861726999282837, 'ma_f_b': 0.5674136281013489}}, {0: {'meta_doa': np.float64(0.5136208331237309), 'pc-er': 0.055816650390625, 'rm': 0.022980124078431936}, 1: {'meta_doa': np.float64(0.5137106662397714), 'pc-er': 0.0570068359375, 'rm': 0.023681290973545474}, 2: {'meta_doa': np.float64(0.5138677433256658), 'pc-er': 0.058380126953125, 'rm': 0.024400209262828206}, 3: {'meta_doa': np.float64(0.514012902629314), 'pc-er': 0.059783935546875, 'rm': 0.025096676817525792}, 4: {'meta_doa': np.float64(0.5143698807185688), 'pc-er': 0.06256103515625, 'rm': 0.02644373018219146}, 5: {'meta_doa': np.float64(0.5146632603502649), 'pc-er': 0.06524658203125, 'rm': 0.02781219882967983}, 6: {'meta_doa': np.float64(0.5149307712288247), 'pc-er': 0.06756591796875, 'rm': 0.029214933724978822}, 7: {'meta_doa': np.float64(0.5151748848323066), 'pc-er': 0.06976318359375, 'rm': 0.030580703739764747}, 8: {'meta_doa': np.float64(0.5157330695900424), 'pc-er': 0.0733642578125, 'rm': 0.03258737946166346}, 9: {'meta_doa': np.float64(0.5162409362873753), 'pc-er': 0.0770263671875, 'rm': 0.034630252102898995}, 10: {'meta_doa': np.float64(0.5167236370000354), 'pc-er': 0.0806884765625, 'rm': 0.03660694834531372}, 11: {'meta_doa': np.float64(0.5170667662273557), 'pc-er': 0.083740234375, 'rm': 0.03863646222808422}, 12: {'meta_doa': np.float64(0.5177017649923401), 'pc-er': 0.0865478515625, 'rm': 0.04130159551111405}, 13: {'meta_doa': np.float64(0.5184729673268822), 'pc-er': 0.09051513671875, 'rm': 0.04402200203698334}, 14: {'meta_doa': np.float64(0.5190518351132765), 'pc-er': 0.09417724609375, 'rm': 0.04667924016032226}, 15: {'meta_doa': np.float64(0.5195792851691878), 'pc-er': 0.09783935546875, 'rm': 0.04928895190428508}})
