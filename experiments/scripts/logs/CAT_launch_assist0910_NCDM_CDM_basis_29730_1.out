PID 3946715 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 58:21] Using device: cuda
[INFO 58:21] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'ncdm', 'i_fold': 1, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.001, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 58:38] Random_cont_model
../ckpt/assist0910_NCDM_fold_1_seed_0
[INFO 58:42] compiling selection model
[INFO 58:50] ⏳ Début de l'entraînement...
[INFO 58:50] ✅ Entraînement terminé en 0.00 secondes.
[INFO 58:50] train on cuda
Meta_loss tensor(1.0057, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0032, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0009, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9989, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9967, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9944, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9915, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9883, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9845, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9808, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9772, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9735, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9696, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9658, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9619, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9577, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9538, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9503, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9474, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9448, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9424, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9400, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9375, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9349, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9324, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9298, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9274, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9255, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9240, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9224, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9209, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9191, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9171, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9154, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9140, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9126, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9112, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9096, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9086, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9082, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9076, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9071, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9066, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9059, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9052, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9041, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9030, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9017, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9007, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8993, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8976, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8961, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8949, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8941, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8938, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8938, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8938, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8938, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8939, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8937, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8936, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8935, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8934, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8936, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8938, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8939, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8939, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8941, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8942, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8939, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8935, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8931, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8931, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8931, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8933, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8934, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8937, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8940, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8944, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8945, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8945, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8945, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8944, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.8941, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
---------- best_epoch : 72 ;   
[WARNING 59:14] Computing RM on meta and QUERY set
[INFO 59:17] RM: -0.009609328908382085
[INFO 59:17] Fold 1; results: ({'mi_acc': 0.6213389039039612, 'rmse': 0.5332471132278442, 'mae': 0.4028560221195221, 'mi_prec': 0.794066309928894, 'mi_rec': 0.6509299278259277, 'mi_f_b': 0.7154088020324707, 'mi_auc': nan, 'ma_prec': 0.5784952640533447, 'ma_rec': 0.5958929657936096, 'ma_f_b': 0.5748919248580933}, {'meta_doa': np.float64(0.4686730054681499), 'pc-er': 0.0160980224609375, 'rm': -0.009609328908382085})
