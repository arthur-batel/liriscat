PID 1909322 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 49:37] Using device: cuda
[INFO 49:37] #### config : {'seed': 0, 'dataset_name': 'math2', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.6180638633142202e-05, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 2, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0030952659036283066, 'meta_lr': 2.0, 'meta_trainer': 'Approx_GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 49:49] Random_cont_model
[INFO 49:50] compiling CDM model
[INFO 49:57] compiling selection model
[INFO 49:57] ⏳ Début de l'entraînement...
[INFO 49:57] ------- START Training
[INFO 49:57] train on cuda
[INFO 51:26] - meta_params: 2.0
[INFO 51:56] rmse : 0.5540987253189087
[INFO 51:56] valid_rmse : 0.7085661292076111
[INFO 51:56] valid_loss : 0.9475435614585876
[INFO 53:25] - meta_params: 2.0
[INFO 53:55] rmse : 0.5494028925895691
[INFO 53:55] valid_rmse : 0.7025612592697144
[INFO 53:55] valid_loss : 0.9448271989822388
[INFO 55:25] - meta_params: 2.0
[INFO 55:54] rmse : 0.558755099773407
[INFO 55:54] valid_rmse : 0.7145205736160278
[INFO 55:54] valid_loss : 0.9431148171424866
[INFO 57:25] - meta_params: 2.0
[INFO 57:54] rmse : 0.5535589456558228
[INFO 57:54] valid_rmse : 0.7078758478164673
[INFO 57:54] valid_loss : 0.9420525431632996
[INFO 59:25] - meta_params: 2.0
[INFO 59:55] rmse : 0.5524777770042419
[INFO 59:55] valid_rmse : 0.7064933180809021
[INFO 59:55] valid_loss : 0.9418808817863464
[INFO 01:25] - meta_params: 2.0
[INFO 01:55] rmse : 0.5544583201408386
[INFO 01:55] valid_rmse : 0.7090259790420532
[INFO 01:55] valid_loss : 0.9446011781692505
[INFO 03:26] - meta_params: 2.0
[INFO 03:55] rmse : 0.5592898726463318
[INFO 03:55] valid_rmse : 0.7152044177055359
[INFO 03:55] valid_loss : 0.9412738084793091
[INFO 05:26] - meta_params: 2.0
[INFO 05:55] rmse : 0.5558942556381226
[INFO 05:55] valid_rmse : 0.7108622193336487
[INFO 05:55] valid_loss : 0.9413679838180542
[INFO 07:26] - meta_params: 2.0
[INFO 07:56] rmse : 0.5548176169395447
[INFO 07:56] valid_rmse : 0.7094854116439819
[INFO 07:56] valid_loss : 0.9425128102302551
[INFO 09:27] - meta_params: 2.0
[INFO 09:57] rmse : 0.5579519867897034
[INFO 09:57] valid_rmse : 0.7134935855865479
[INFO 09:57] valid_loss : 0.942564845085144
[INFO 11:27] - meta_params: 1.0
[INFO 11:57] rmse : 0.564168393611908
[INFO 11:57] valid_rmse : 0.7214429378509521
[INFO 11:57] valid_loss : 0.9448702931404114
[INFO 13:27] - meta_params: 1.0
[INFO 13:57] rmse : 0.554278552532196
[INFO 13:57] valid_rmse : 0.7087960839271545
[INFO 13:57] valid_loss : 0.944449782371521
[INFO 15:29] - meta_params: 1.0
[INFO 15:58] rmse : 0.5617787837982178
[INFO 15:58] valid_rmse : 0.7183871865272522
[INFO 15:58] valid_loss : 0.9442130923271179
[INFO 17:29] - meta_params: 0.5
[INFO 17:59] rmse : 0.5594680309295654
[INFO 17:59] valid_rmse : 0.7154322266578674
[INFO 17:59] valid_loss : 0.9430736899375916
[INFO 19:30] - meta_params: 0.5
[INFO 20:00] rmse : 0.5547277927398682
[INFO 20:00] valid_rmse : 0.7093705534934998
[INFO 20:00] valid_loss : 0.9431774616241455
[INFO 21:32] - meta_params: 0.5
[INFO 22:02] rmse : 0.5517557859420776
[INFO 22:02] valid_rmse : 0.7055700421333313
[INFO 22:02] valid_loss : 0.9424470663070679
[INFO 23:32] - meta_params: 0.25
[INFO 24:02] rmse : 0.5615126490592957
[INFO 24:02] valid_rmse : 0.7180468440055847
[INFO 24:02] valid_loss : 0.9428068995475769
[INFO 25:33] - meta_params: 0.25
[INFO 26:03] rmse : 0.559378981590271
[INFO 26:03] valid_rmse : 0.7153183817863464
[INFO 26:03] valid_loss : 0.9437989592552185
[INFO 27:34] - meta_params: 0.25
[INFO 28:04] rmse : 0.555535614490509
[INFO 28:04] valid_rmse : 0.710403561592102
[INFO 28:04] valid_loss : 0.9423085451126099
[INFO 29:34] - meta_params: 0.125
[INFO 30:04] rmse : 0.5518460869789124
[INFO 30:04] valid_rmse : 0.7056854963302612
[INFO 30:04] valid_loss : 0.9430824518203735
[INFO 31:34] - meta_params: 0.125
[INFO 32:04] rmse : 0.5474950671195984
[INFO 32:04] valid_rmse : 0.7001215815544128
[INFO 32:04] valid_loss : 0.9421609044075012
[INFO 33:34] - meta_params: 0.125
[INFO 34:03] rmse : 0.558844268321991
[INFO 34:03] valid_rmse : 0.7146345973014832
[INFO 34:03] valid_loss : 0.9441959261894226
[INFO 35:34] - meta_params: 0.0625
[INFO 36:03] rmse : 0.5684794783592224
[INFO 36:03] valid_rmse : 0.7269558310508728
[INFO 36:03] valid_loss : 0.9445885419845581
[INFO 37:32] - meta_params: 0.0625
[INFO 38:00] rmse : 0.5540087819099426
[INFO 38:00] valid_rmse : 0.7084510922431946
[INFO 38:00] valid_loss : 0.9413078427314758
[INFO 39:26] - meta_params: 0.0625
[INFO 39:54] rmse : 0.5492214560508728
[INFO 39:54] valid_rmse : 0.7023292183876038
[INFO 39:54] valid_loss : 0.9415310621261597
[INFO 41:19] - meta_params: 0.03125
[INFO 41:47] rmse : 0.5547277927398682
[INFO 41:47] valid_rmse : 0.7093705534934998
[INFO 41:47] valid_loss : 0.9432705640792847
[INFO 43:11] - meta_params: 0.03125
[INFO 43:39] rmse : 0.5549074411392212
[INFO 43:39] valid_rmse : 0.7096002697944641
[INFO 43:39] valid_loss : 0.9420044422149658
[INFO 45:03] - meta_params: 0.03125
[INFO 45:31] rmse : 0.5566108822822571
[INFO 45:31] valid_rmse : 0.7117785811424255
[INFO 45:31] valid_loss : 0.9425525665283203
[INFO 46:55] - meta_params: 0.015625
[INFO 47:23] rmse : 0.5531988143920898
[INFO 47:23] valid_rmse : 0.7074153423309326
[INFO 47:23] valid_loss : 0.9423167109489441
[INFO 48:47] - meta_params: 0.015625
[INFO 49:15] rmse : 0.5560734868049622
[INFO 49:15] valid_rmse : 0.7110913991928101
[INFO 49:15] valid_loss : 0.9426289796829224
[INFO 50:39] - meta_params: 0.015625
[INFO 51:06] rmse : 0.5596461296081543
[INFO 51:06] valid_rmse : 0.7156599760055542
[INFO 51:06] valid_loss : 0.9439963698387146
[INFO 52:30] - meta_params: 0.0078125
[INFO 52:58] rmse : 0.5604467988014221
[INFO 52:58] valid_rmse : 0.7166838645935059
[INFO 52:58] valid_loss : 0.9440540075302124
[INFO 54:22] - meta_params: 0.0078125
[INFO 54:50] rmse : 0.5575946569442749
[INFO 54:50] valid_rmse : 0.7130366563796997
[INFO 54:50] valid_loss : 0.9458822011947632
[INFO 56:14] - meta_params: 0.0078125
[INFO 56:42] rmse : 0.5523875951766968
[INFO 56:42] valid_rmse : 0.7063779830932617
[INFO 56:42] valid_loss : 0.9427801370620728
[INFO 58:06] - meta_params: 0.00390625
[INFO 58:34] rmse : 0.5622220635414124
[INFO 58:34] valid_rmse : 0.7189540266990662
[INFO 58:34] valid_loss : 0.9433141946792603
[INFO 59:58] - meta_params: 0.00390625
[INFO 00:26] rmse : 0.5621334314346313
[INFO 00:26] valid_rmse : 0.7188407182693481
[INFO 00:26] valid_loss : 0.9444189667701721
[INFO 01:50] - meta_params: 0.00390625
[INFO 02:18] rmse : 0.5571476817131042
[INFO 02:18] valid_rmse : 0.7124650478363037
[INFO 02:18] valid_loss : 0.9420889616012573
[INFO 03:42] - meta_params: 0.001953125
[INFO 04:09] rmse : 0.5569688081741333
[INFO 04:09] valid_rmse : 0.7122362852096558
[INFO 04:09] valid_loss : 0.9421560168266296
[INFO 05:34] - meta_params: 0.001953125
[INFO 06:01] rmse : 0.5563422441482544
[INFO 06:01] valid_rmse : 0.711435079574585
[INFO 06:01] valid_loss : 0.9422647953033447
[INFO 07:26] - meta_params: 0.001953125
[INFO 07:53] rmse : 0.55598384141922
[INFO 07:53] valid_rmse : 0.710976779460907
[INFO 07:53] valid_loss : 0.9440242052078247
[INFO 09:18] - meta_params: 0.0009765625
[INFO 09:46] rmse : 0.5576840043067932
[INFO 09:46] valid_rmse : 0.7131508588790894
[INFO 09:46] valid_loss : 0.94319087266922
[INFO 09:46] -- END Training --
[INFO 09:46] ✅ Entraînement terminé en 4788.85 secondes.
[INFO 09:46] train on cuda
[WARNING 10:17] Computing RM on meta and QUERY set
[INFO 10:20] RM: 0.022598495562587324
[WARNING 10:21] Computing RM on meta and QUERY set
[INFO 10:22] RM: 0.0550519358086925
[WARNING 10:23] Computing RM on meta and QUERY set
[INFO 10:23] RM: 0.09484980699111227
[WARNING 10:25] Computing RM on meta and QUERY set
[INFO 10:25] RM: 0.14113536964364
[WARNING 10:26] Computing RM on meta and QUERY set
[INFO 10:26] RM: 0.19838400947478046
[WARNING 10:28] Computing RM on meta and QUERY set
[INFO 10:28] RM: 0.25238111327134966
[WARNING 10:29] Computing RM on meta and QUERY set
[INFO 10:29] RM: 0.30373324531484713
[WARNING 10:31] Computing RM on meta and QUERY set
[INFO 10:31] RM: 0.35192029734035796
[WARNING 10:33] Computing RM on meta and QUERY set
[INFO 10:33] RM: 0.39665709449605363
[WARNING 10:34] Computing RM on meta and QUERY set
[INFO 10:34] RM: 0.442674585706647
[WARNING 10:36] Computing RM on meta and QUERY set
[INFO 10:36] RM: 0.48718874386363037
[WARNING 10:37] Computing RM on meta and QUERY set
[INFO 10:37] RM: 0.5297613614262114
[WARNING 10:39] Computing RM on meta and QUERY set
[INFO 10:39] RM: 0.569590134564028
[WARNING 10:41] Computing RM on meta and QUERY set
[INFO 10:41] RM: 0.6095235072570511
[WARNING 10:42] Computing RM on meta and QUERY set
[INFO 10:42] RM: 0.6466154003629203
[WARNING 10:44] Computing RM on meta and QUERY set
[INFO 10:44] RM: 0.6816300460829597
[INFO 10:44] Fold 2; pareto_index: 6.254698835870427; results: ({0: {'mi_acc': 0.6481314897537231, 'rmse': 0.5931850075721741, 'mae': 0.3518684506416321, 'mi_prec': 0.5845782160758972, 'mi_rec': 0.6186933517456055, 'mi_f_b': 0.6011521816253662, 'mi_auc': 0.6444530465453359, 'ma_prec': 0.6427359580993652, 'ma_rec': 0.6444530487060547, 'ma_f_b': 0.6431810855865479}, 1: {'mi_acc': 0.6493273377418518, 'rmse': 0.5921761989593506, 'mae': 0.3506726324558258, 'mi_prec': 0.5850175619125366, 'mi_rec': 0.6203121542930603, 'mi_f_b': 0.6021481156349182, 'mi_auc': 0.6456663431831507, 'ma_prec': 0.6438674926757812, 'ma_rec': 0.6456663608551025, 'ma_f_b': 0.6443257331848145}, 2: {'mi_acc': 0.654309868812561, 'rmse': 0.5879541635513306, 'mae': 0.3456900715827942, 'mi_prec': 0.5898506045341492, 'mi_rec': 0.6263120770454407, 'mi_f_b': 0.6075347661972046, 'mi_auc': 0.6507517386398555, 'ma_prec': 0.6488373875617981, 'ma_rec': 0.6507517099380493, 'ma_f_b': 0.6493287682533264}, 3: {'mi_acc': 0.6624813079833984, 'rmse': 0.5809635519981384, 'mae': 0.3375186622142792, 'mi_prec': 0.5944639444351196, 'mi_rec': 0.6371556520462036, 'mi_f_b': 0.6150698661804199, 'mi_auc': 0.6591099550900519, 'ma_prec': 0.656706690788269, 'ma_rec': 0.6591099500656128, 'ma_f_b': 0.6572821140289307}, 4: {'mi_acc': 0.668360710144043, 'rmse': 0.57588130235672, 'mae': 0.33163926005363464, 'mi_prec': 0.6052284836769104, 'mi_rec': 0.6427904963493347, 'mi_f_b': 0.6234441995620728, 'mi_auc': 0.6651071902216433, 'ma_prec': 0.6630008816719055, 'ma_rec': 0.6651071906089783, 'ma_f_b': 0.6635739803314209}, 5: {'mi_acc': 0.6697558164596558, 'rmse': 0.5746687054634094, 'mae': 0.33024412393569946, 'mi_prec': 0.6091827750205994, 'mi_rec': 0.6436861753463745, 'mi_f_b': 0.6259593963623047, 'mi_auc': 0.6665261627836281, 'ma_prec': 0.6646132469177246, 'ma_rec': 0.666526198387146, 'ma_f_b': 0.6651651859283447}, 6: {'mi_acc': 0.6763328313827515, 'rmse': 0.5689175128936768, 'mae': 0.32366713881492615, 'mi_prec': 0.6192882061004639, 'mi_rec': 0.6504383683204651, 'mi_f_b': 0.6344812512397766, 'mi_auc': 0.6732283182534141, 'ma_prec': 0.6714898347854614, 'ma_rec': 0.6732282638549805, 'ma_f_b': 0.6720331907272339}, 7: {'mi_acc': 0.6800199151039124, 'rmse': 0.5656678080558777, 'mae': 0.31998005509376526, 'mi_prec': 0.6307117938995361, 'mi_rec': 0.6523517370223999, 'mi_f_b': 0.6413493156433105, 'mi_auc': 0.6769923405441546, 'ma_prec': 0.6758337020874023, 'ma_rec': 0.6769922971725464, 'ma_f_b': 0.6762561798095703}, 8: {'mi_acc': 0.6869955062866211, 'rmse': 0.5594680309295654, 'mae': 0.3130044639110565, 'mi_prec': 0.6419156193733215, 'mi_rec': 0.659147322177887, 'mi_f_b': 0.6504173278808594, 'mi_auc': 0.6840898963527979, 'ma_prec': 0.6831682920455933, 'ma_rec': 0.6840898990631104, 'ma_f_b': 0.6835307478904724}, 9: {'mi_acc': 0.6899850368499756, 'rmse': 0.5567898750305176, 'mae': 0.310014933347702, 'mi_prec': 0.6410369277000427, 'mi_rec': 0.6639363169670105, 'mi_f_b': 0.6522857546806335, 'mi_auc': 0.6871099895916539, 'ma_prec': 0.6858294010162354, 'ma_rec': 0.6871100068092346, 'ma_f_b': 0.6862975358963013}, 10: {'mi_acc': 0.6892874836921692, 'rmse': 0.5574159026145935, 'mae': 0.3107124865055084, 'mi_prec': 0.6449912190437317, 'mi_rec': 0.6615592837333679, 'mi_f_b': 0.6531702280044556, 'mi_auc': 0.6864165788293688, 'ma_prec': 0.6855267882347107, 'ma_rec': 0.6864166259765625, 'ma_f_b': 0.6858811378479004}, 11: {'mi_acc': 0.6921773552894592, 'rmse': 0.5548176169395447, 'mae': 0.3078226149082184, 'mi_prec': 0.643892765045166, 'mi_rec': 0.6662877798080444, 'mi_f_b': 0.6548988819122314, 'mi_auc': 0.6893362313294313, 'ma_prec': 0.6880780458450317, 'ma_rec': 0.6893361806869507, 'ma_f_b': 0.6885430812835693}, 12: {'mi_acc': 0.6902839541435242, 'rmse': 0.5565212965011597, 'mae': 0.30971598625183105, 'mi_prec': 0.6445518732070923, 'mi_rec': 0.6632007360458374, 'mi_f_b': 0.653743326663971, 'mi_auc': 0.6874192887711204, 'ma_prec': 0.6864014267921448, 'ma_rec': 0.6874192953109741, 'ma_f_b': 0.6867959499359131}, 13: {'mi_acc': 0.6868958473205566, 'rmse': 0.5595570802688599, 'mae': 0.31310412287712097, 'mi_prec': 0.6474077105522156, 'mi_rec': 0.6572256684303284, 'mi_f_b': 0.6522797346115112, 'mi_auc': 0.6840442994656153, 'ma_prec': 0.68354332447052, 'ma_rec': 0.6840443015098572, 'ma_f_b': 0.683761715888977}, 14: {'mi_acc': 0.684105634689331, 'rmse': 0.5620447993278503, 'mae': 0.31589436531066895, 'mi_prec': 0.6441124677658081, 'mi_rec': 0.6541722416877747, 'mi_f_b': 0.6491033434867859, 'mi_auc': 0.681219023401367, 'ma_prec': 0.6807102560997009, 'ma_rec': 0.6812189817428589, 'ma_f_b': 0.6809307336807251}, 15: {'mi_acc': 0.6807174682617188, 'rmse': 0.5650508999824524, 'mae': 0.31928250193595886, 'mi_prec': 0.6405975222587585, 'mi_rec': 0.6503122448921204, 'mi_f_b': 0.6454183459281921, 'mi_auc': 0.6777952747300958, 'ma_prec': 0.6773113012313843, 'ma_rec': 0.6777952909469604, 'ma_f_b': 0.6775215864181519}}, {0: {'meta_doa': np.float64(0.503446560501126), 'pc-er': -0.05908203125, 'rm': 0.022598495562587324}, 1: {'meta_doa': np.float64(0.5094852614526991), 'pc-er': -0.052398681640625, 'rm': 0.0550519358086925}, 2: {'meta_doa': np.float64(0.5168409165121921), 'pc-er': -0.043975830078125, 'rm': 0.09484980699111227}, 3: {'meta_doa': np.float64(0.525630931547899), 'pc-er': -0.033843994140625, 'rm': 0.14113536964364}, 4: {'meta_doa': np.float64(0.5369018855359424), 'pc-er': -0.02166748046875, 'rm': 0.19838400947478046}, 5: {'meta_doa': np.float64(0.5483436830571602), 'pc-er': -0.0109710693359375, 'rm': 0.25238111327134966}, 6: {'meta_doa': np.float64(0.5599008000030357), 'pc-er': -0.0008358955383300781, 'rm': 0.30373324531484713}, 7: {'meta_doa': np.float64(0.57116422581813), 'pc-er': 0.0088958740234375, 'rm': 0.35192029734035796}, 8: {'meta_doa': np.float64(0.5820333052998583), 'pc-er': 0.0171966552734375, 'rm': 0.39665709449605363}, 9: {'meta_doa': np.float64(0.5935098026216055), 'pc-er': 0.0249786376953125, 'rm': 0.442674585706647}, 10: {'meta_doa': np.float64(0.6048996506488145), 'pc-er': 0.0338134765625, 'rm': 0.48718874386363037}, 11: {'meta_doa': np.float64(0.6162315895913055), 'pc-er': 0.0421142578125, 'rm': 0.5297613614262114}, 12: {'meta_doa': np.float64(0.6271433354260443), 'pc-er': 0.0489501953125, 'rm': 0.569590134564028}, 13: {'meta_doa': np.float64(0.6385879962086851), 'pc-er': 0.0555419921875, 'rm': 0.6095235072570511}, 14: {'meta_doa': np.float64(0.6494907996806789), 'pc-er': 0.0623779296875, 'rm': 0.6466154003629203}, 15: {'meta_doa': np.float64(0.6599944371329907), 'pc-er': 0.06793212890625, 'rm': 0.6816300460829597}})
