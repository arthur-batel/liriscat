PID 3341079 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 52:21] Using device: cuda
[INFO 52:21] #### config : {'seed': 0, 'dataset_name': 'math2', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.003, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 1, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 0, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 3, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.0005, 'meta_lr': 0.01, 'meta_trainer': 'GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False, 'learning_users_emb_lr': 0.001} ####
[INFO 52:34] Random_cont_model
[INFO 52:34] compiling CDM model
[INFO 52:44] compiling selection model
[INFO 52:44] ⏳ Training started...
[INFO 52:44] ------- START Training
[INFO 52:44] train on cuda
[INFO 54:16] - meta_params: 0.01
[INFO 54:16] - cross_cond: 0.01
[INFO 54:16] - meta_lambda: 0.01
[INFO 54:16] - learning_users_emb: 0.001
[INFO 54:47] rmse : 0.5598241686820984
[INFO 54:47] valid_rmse : 0.7158876657485962
[INFO 54:47] valid_loss : 0.26135489344596863
[INFO 56:19] - meta_params: 0.01
[INFO 56:19] - cross_cond: 0.01
[INFO 56:19] - meta_lambda: 0.01
[INFO 56:19] - learning_users_emb: 0.001
[INFO 56:51] rmse : 0.560535728931427
[INFO 56:51] valid_rmse : 0.7167975902557373
[INFO 56:51] valid_loss : 0.2673512101173401
[INFO 56:51] -- END Training --
[INFO 56:51] ✅ Training completed in 246.53 seconds.
[INFO 56:51] train on cuda
[WARNING 57:25] Computing RM on meta and QUERY set
[INFO 57:27] RM: 0.41030117671595806
[WARNING 57:29] Computing RM on meta and QUERY set
[INFO 57:29] RM: 0.4738734998562108
[WARNING 57:31] Computing RM on meta and QUERY set
[INFO 57:31] RM: 0.5232472530974094
[WARNING 57:32] Computing RM on meta and QUERY set
[INFO 57:32] RM: 0.5650175995034222
[WARNING 57:34] Computing RM on meta and QUERY set
[INFO 57:34] RM: 0.6009785871199645
[WARNING 57:35] Computing RM on meta and QUERY set
[INFO 57:35] RM: 0.6350194000371515
[WARNING 57:37] Computing RM on meta and QUERY set
[INFO 57:37] RM: 0.6658037089987041
[WARNING 57:39] Computing RM on meta and QUERY set
[INFO 57:39] RM: 0.6932346568216504
[WARNING 57:40] Computing RM on meta and QUERY set
[INFO 57:40] RM: 0.7190896014558659
[WARNING 57:42] Computing RM on meta and QUERY set
[INFO 57:42] RM: 0.7443541923882683
[WARNING 57:43] Computing RM on meta and QUERY set
[INFO 57:43] RM: 0.7681258067094788
[WARNING 57:45] Computing RM on meta and QUERY set
[INFO 57:45] RM: 0.7901850557289292
[WARNING 57:47] Computing RM on meta and QUERY set
[INFO 57:47] RM: 0.810234420065428
[WARNING 57:48] Computing RM on meta and QUERY set
[INFO 57:48] RM: 0.8296509633290027
[WARNING 57:50] Computing RM on meta and QUERY set
[INFO 57:50] RM: 0.8488793033581022
[WARNING 57:52] Computing RM on meta and QUERY set
[INFO 57:52] RM: 0.8672262913309725
[INFO 57:52]  results: {0: {'mi_acc': 0.6905829310417175, 'rmse': 0.556252658367157, 'mae': 0.3094170391559601, 'mi_prec': 0.6557675004005432, 'mi_rec': 0.6450748443603516, 'mi_f_b': 0.6503772735595703, 'mi_auc': 0.6861574206433377, 'ma_prec': 0.6867898106575012, 'ma_rec': 0.6861574649810791, 'ma_f_b': 0.6864362955093384}, 1: {'mi_acc': 0.6933731436729431, 'rmse': 0.5537389516830444, 'mae': 0.3066267967224121, 'mi_prec': 0.6514531970024109, 'mi_rec': 0.6504194140434265, 'mi_f_b': 0.6509358882904053, 'mi_auc': 0.6887409974675364, 'ma_prec': 0.6888059377670288, 'ma_rec': 0.6887409687042236, 'ma_f_b': 0.6887731552124023}, 2: {'mi_acc': 0.699152946472168, 'rmse': 0.5484952330589294, 'mae': 0.30084702372550964, 'mi_prec': 0.6639418601989746, 'mi_rec': 0.6551646590232849, 'mi_f_b': 0.6595240235328674, 'mi_auc': 0.6947754521141284, 'ma_prec': 0.6953166723251343, 'ma_rec': 0.6947754621505737, 'ma_f_b': 0.695021390914917}, 3: {'mi_acc': 0.6996511816978455, 'rmse': 0.5480408072471619, 'mae': 0.30034875869750977, 'mi_prec': 0.6641689538955688, 'mi_rec': 0.6558296084403992, 'mi_f_b': 0.6599729657173157, 'mi_auc': 0.6952690582959641, 'ma_prec': 0.695785403251648, 'ma_rec': 0.6952691078186035, 'ma_f_b': 0.6955049633979797}, 4: {'mi_acc': 0.7002490758895874, 'rmse': 0.5474950671195984, 'mae': 0.2997508645057678, 'mi_prec': 0.657584011554718, 'mi_rec': 0.6587806940078735, 'mi_f_b': 0.6581817865371704, 'mi_auc': 0.6956787038661112, 'ma_prec': 0.6956007480621338, 'ma_rec': 0.6956787109375, 'ma_f_b': 0.6956392526626587}, 5: {'mi_acc': 0.7042351365089417, 'rmse': 0.543842613697052, 'mae': 0.2957648038864136, 'mi_prec': 0.6614441275596619, 'mi_rec': 0.6635535359382629, 'mi_f_b': 0.6624971628189087, 'mi_auc': 0.6997129921251899, 'ma_prec': 0.6995730400085449, 'ma_rec': 0.6997129917144775, 'ma_f_b': 0.6996416449546814}, 6: {'mi_acc': 0.6993522644042969, 'rmse': 0.548313558101654, 'mae': 0.3006477355957031, 'mi_prec': 0.6559945344924927, 'mi_rec': 0.657936692237854, 'mi_f_b': 0.6569641828536987, 'mi_auc': 0.6947550204569265, 'ma_prec': 0.6946284174919128, 'ma_rec': 0.6947550177574158, 'ma_f_b': 0.694690465927124}, 7: {'mi_acc': 0.6990532875061035, 'rmse': 0.5485860705375671, 'mae': 0.3009466826915741, 'mi_prec': 0.6521344184875488, 'mi_rec': 0.6587156057357788, 'mi_f_b': 0.655408501625061, 'mi_auc': 0.6943798245968558, 'ma_prec': 0.6939414739608765, 'ma_rec': 0.6943798065185547, 'ma_f_b': 0.6941468715667725}, 8: {'mi_acc': 0.7032386660575867, 'rmse': 0.5447580218315125, 'mae': 0.29676133394241333, 'mi_prec': 0.6521344184875488, 'mi_rec': 0.6651227474212646, 'mi_f_b': 0.658564567565918, 'mi_auc': 0.6985750145244233, 'ma_prec': 0.6976708173751831, 'ma_rec': 0.6985750198364258, 'ma_f_b': 0.69806969165802}, 9: {'mi_acc': 0.7028400301933289, 'rmse': 0.5451237559318542, 'mae': 0.29715994000434875, 'mi_prec': 0.6532697677612305, 'mi_rec': 0.6641274094581604, 'mi_f_b': 0.6586539149284363, 'mi_auc': 0.6981868050202474, 'ma_prec': 0.6974393725395203, 'ma_rec': 0.6981867551803589, 'ma_f_b': 0.6977758407592773}, 10: {'mi_acc': 0.7046337723731995, 'rmse': 0.5434760451316833, 'mae': 0.29536619782447815, 'mi_prec': 0.6564486622810364, 'mi_rec': 0.6658222079277039, 'mi_f_b': 0.6611021757125854, 'mi_auc': 0.7000286136101104, 'ma_prec': 0.6993839740753174, 'ma_rec': 0.700028657913208, 'ma_f_b': 0.6996785998344421}, 11: {'mi_acc': 0.7008470296859741, 'rmse': 0.5469487309455872, 'mae': 0.2991529405117035, 'mi_prec': 0.657584011554718, 'mi_rec': 0.6596810817718506, 'mi_f_b': 0.658630907535553, 'mi_auc': 0.6962710161390228, 'ma_prec': 0.6961334943771362, 'ma_rec': 0.6962710022926331, 'ma_f_b': 0.6962008476257324}, 12: {'mi_acc': 0.6948679089546204, 'rmse': 0.5523875951766968, 'mae': 0.30513203144073486, 'mi_prec': 0.6546321511268616, 'mi_rec': 0.6516727209091187, 'mi_f_b': 0.6531490683555603, 'mi_auc': 0.6902990098240893, 'ma_prec': 0.6904842853546143, 'ma_rec': 0.6902990341186523, 'ma_f_b': 0.6903887987136841}, 13: {'mi_acc': 0.6937717795372009, 'rmse': 0.5533788800239563, 'mae': 0.3062281906604767, 'mi_prec': 0.6580381393432617, 'mi_rec': 0.6490481495857239, 'mi_f_b': 0.6535122394561768, 'mi_auc': 0.6893355662734897, 'ma_prec': 0.6898785829544067, 'ma_rec': 0.6893355846405029, 'ma_f_b': 0.6895808577537537}, 14: {'mi_acc': 0.693572461605072, 'rmse': 0.5535589456558228, 'mae': 0.3064274787902832, 'mi_prec': 0.6571298837661743, 'mi_rec': 0.6490244269371033, 'mi_f_b': 0.653052031993866, 'mi_auc': 0.6891105008071307, 'ma_prec': 0.6896020174026489, 'ma_rec': 0.689110517501831, 'ma_f_b': 0.6893349885940552}, 15: {'mi_acc': 0.6968609690666199, 'rmse': 0.550580620765686, 'mae': 0.30313900113105774, 'mi_prec': 0.6609899997711182, 'mi_rec': 0.652690589427948, 'mi_f_b': 0.6568140387535095, 'mi_auc': 0.6924439461883408, 'ma_prec': 0.6929528117179871, 'ma_rec': 0.6924439668655396, 'ma_f_b': 0.6926761865615845}},

 {0: {'meta_doa': np.float64(0.5507273664568839), 'pc-er': 0.08856201171875, 'rm': 0.41030117671595806}, 1: {'meta_doa': np.float64(0.5780944002982124), 'pc-er': 0.09124755859375, 'rm': 0.4738734998562108}, 2: {'meta_doa': np.float64(0.5988020339126645), 'pc-er': 0.0916748046875, 'rm': 0.5232472530974094}, 3: {'meta_doa': np.float64(0.621423440166265), 'pc-er': 0.08685302734375, 'rm': 0.5650175995034222}, 4: {'meta_doa': np.float64(0.6404174811137824), 'pc-er': 0.08563232421875, 'rm': 0.6009785871199645}, 5: {'meta_doa': np.float64(0.6532525686440712), 'pc-er': 0.08575439453125, 'rm': 0.6350194000371515}, 6: {'meta_doa': np.float64(0.6658288862065747), 'pc-er': 0.0877685546875, 'rm': 0.6658037089987041}, 7: {'meta_doa': np.float64(0.6773711634284671), 'pc-er': 0.08538818359375, 'rm': 0.6932346568216504}, 8: {'meta_doa': np.float64(0.6903362748007663), 'pc-er': 0.08416748046875, 'rm': 0.7190896014558659}, 9: {'meta_doa': np.float64(0.7033037679289346), 'pc-er': 0.08172607421875, 'rm': 0.7443541923882683}, 10: {'meta_doa': np.float64(0.7136689029117553), 'pc-er': 0.08087158203125, 'rm': 0.7681258067094788}, 11: {'meta_doa': np.float64(0.7232003446363918), 'pc-er': 0.0780029296875, 'rm': 0.7901850557289292}, 12: {'meta_doa': np.float64(0.7332391141249011), 'pc-er': 0.07568359375, 'rm': 0.810234420065428}, 13: {'meta_doa': np.float64(0.7417909071198028), 'pc-er': 0.07470703125, 'rm': 0.8296509633290027}, 14: {'meta_doa': np.float64(0.7500548096027102), 'pc-er': 0.07330322265625, 'rm': 0.8488793033581022}, 15: {'meta_doa': np.float64(0.7576797926815504), 'pc-er': 0.07208251953125, 'rm': 0.8672262913309725}},

 torch.Size([16, 3911, 16]), 

 [tensor([                  3,                   3,                   8,
         ..., 9223372036854775807, 9223372036854775807,
        9223372036854775807], device='cuda:0'), tensor([                 16,                  16,                  17,
         ..., 9223372036854775807, 9223372036854775807,
        9223372036854775807], device='cuda:0'), tensor([                  2,                   2,                   2,
         ..., 9223372036854775807, 9223372036854775807,
        9223372036854775807], device='cuda:0'), tensor([                  2,                   2,                   1,
         ..., 9223372036854775807, 9223372036854775807,
        9223372036854775807], device='cuda:0')]
