PID 3946719 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 58:21] Using device: cuda
[INFO 58:21] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'ncdm', 'i_fold': 0, 'num_inner_users_epochs': 9, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.001, 'meta_lr': 0.05, 'meta_trainer': 'Adam', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 58:38] Random_cont_model
../ckpt/assist0910_NCDM_fold_0_seed_0
[INFO 58:42] compiling selection model
[INFO 58:50] ⏳ Début de l'entraînement...
[INFO 58:50] ✅ Entraînement terminé en 0.00 secondes.
[INFO 58:50] train on cuda
Meta_loss tensor(1.0858, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0794, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0728, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0663, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0597, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0530, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0463, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0395, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0330, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0271, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0220, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0173, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0134, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0099, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0068, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0039, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(1.0008, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9970, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9932, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9896, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9860, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9822, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9784, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9753, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9729, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9710, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9694, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9678, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9663, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9647, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9634, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9622, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9606, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9590, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9573, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9553, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9534, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9515, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9492, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9468, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9451, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9433, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9420, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9412, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9407, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9403, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9398, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9393, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9380, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9355, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9330, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9314, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9304, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9297, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9294, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9292, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9289, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9284, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9277, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9269, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9260, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9250, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9239, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9229, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9221, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9212, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9207, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9206, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9205, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9207, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9204, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9195, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9185, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9174, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9167, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9161, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9155, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9150, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9144, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9141, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9140, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9143, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9144, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9147, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9149, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9153, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9155, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9157, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9156, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9153, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9150, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
Meta_loss tensor(0.9147, device='cuda:0', grad_fn=<BinaryCrossEntropyBackward0>)
---------- best_epoch : 80 ;   
[WARNING 59:15] Computing RM on meta and QUERY set
[INFO 59:17] RM: 0.010364536198761827
[INFO 59:17] Fold 0; results: ({'mi_acc': 0.6099585294723511, 'rmse': 0.5372531414031982, 'mae': 0.4133128821849823, 'mi_prec': 0.7508680820465088, 'mi_rec': 0.6503759622573853, 'mi_f_b': 0.697018563747406, 'mi_auc': nan, 'ma_prec': 0.5758206248283386, 'ma_rec': 0.5852214097976685, 'ma_f_b': 0.5748556852340698}, {'meta_doa': np.float64(0.48780443482163394), 'pc-er': -0.147216796875, 'rm': 0.010364536198761827})
