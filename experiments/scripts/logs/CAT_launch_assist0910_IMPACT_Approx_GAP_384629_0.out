PID 3071615 sees CUDA_VISIBLE_DEVICES = 0
→ torch.device is 0 Tesla V100-SXM2-16GB
[INFO 13:54] Using device: cuda
[INFO 13:54] #### config : {'seed': 0, 'dataset_name': 'assist0910', 'load_params': True, 'save_params': False, 'embs_path': '../embs/', 'params_path': '../ckpt/', 'early_stopping': True, 'esc': 'error', 'verbose_early_stopping': False, 'disable_tqdm': False, 'valid_metric': 'rmse', 'learning_rate': 0.001, 'batch_size': 512, 'valid_batch_size': 10000, 'num_epochs': 100, 'eval_freq': 1, 'patience': 20, 'device': device(type='cuda'), 'lambda': 2.67605964593852e-06, 'tensorboard': False, 'flush_freq': True, 'pred_metrics': ['mi_acc', 'rmse', 'mae', 'mi_prec', 'mi_rec', 'mi_f_b', 'mi_auc', 'ma_prec', 'ma_rec', 'ma_f_b'], 'profile_metrics': ['meta_doa', 'pc-er', 'rm'], 'num_responses': 12, 'low_mem': False, 'n_query': 16, 'CDM': 'impact', 'i_fold': 0, 'num_inner_users_epochs': 3, 'num_inner_epochs': 10, 'inner_lr': 0.0001, 'inner_user_lr': 0.01, 'meta_lr': 2.0, 'meta_trainer': 'Approx_GAP', 'num_workers': 0, 'pin_memory': False, 'debug': False} ####
[INFO 14:12] Random_cont_model
[INFO 14:12] compiling CDM model
[INFO 14:23] compiling selection model
[INFO 14:23] ⏳ Début de l'entraînement...
[INFO 14:23] ------- START Training
[INFO 14:23] train on cuda
[INFO 14:43] - meta_params: 2.0
[INFO 14:50] rmse : 0.5559679865837097
[INFO 14:50] valid_rmse : 1.3560194969177246
[INFO 14:50] valid_loss : 1.655579686164856
[INFO 15:03] - meta_params: 2.0
[INFO 15:09] rmse : 0.5540833473205566
[INFO 15:09] valid_rmse : 1.3514227867126465
[INFO 15:09] valid_loss : 1.6538878679275513
[INFO 15:20] - meta_params: 2.0
[INFO 15:26] rmse : 0.5521922707557678
[INFO 15:26] valid_rmse : 1.3468104600906372
[INFO 15:26] valid_loss : 1.6458441019058228
[INFO 15:37] - meta_params: 2.0
[INFO 15:42] rmse : 0.542155921459198
[INFO 15:42] valid_rmse : 1.3223315477371216
[INFO 15:42] valid_loss : 1.6300742626190186
[INFO 15:53] - meta_params: 2.0
[INFO 15:58] rmse : 0.52300626039505
[INFO 15:58] valid_rmse : 1.2756251096725464
[INFO 15:58] valid_loss : 1.6115851402282715
[INFO 16:08] - meta_params: 2.0
[INFO 16:14] rmse : 0.5363365411758423
[INFO 16:14] valid_rmse : 1.3081378936767578
[INFO 16:14] valid_loss : 1.6490265130996704
[INFO 16:23] - meta_params: 2.0
[INFO 16:29] rmse : 0.5279826521873474
[INFO 16:29] valid_rmse : 1.2877626419067383
[INFO 16:29] valid_loss : 1.6266740560531616
[INFO 16:38] - meta_params: 2.0
[INFO 16:43] rmse : 0.5139273405075073
[INFO 16:43] valid_rmse : 1.253481388092041
[INFO 16:43] valid_loss : 1.6172571182250977
[INFO 16:53] - meta_params: 1.0
[INFO 16:58] rmse : 0.5274871587753296
[INFO 16:58] valid_rmse : 1.2865540981292725
[INFO 16:58] valid_loss : 1.6348981857299805
[INFO 17:07] - meta_params: 1.0
[INFO 17:12] rmse : 0.5205002427101135
[INFO 17:12] valid_rmse : 1.2695127725601196
[INFO 17:12] valid_loss : 1.610487937927246
[INFO 17:21] - meta_params: 1.0
[INFO 17:26] rmse : 0.5129086971282959
[INFO 17:26] valid_rmse : 1.2509968280792236
[INFO 17:26] valid_loss : 1.6063531637191772
[INFO 17:35] - meta_params: 1.0
[INFO 17:40] rmse : 0.5225059986114502
[INFO 17:40] valid_rmse : 1.2744048833847046
[INFO 17:40] valid_loss : 1.625447392463684
[INFO 17:48] - meta_params: 1.0
[INFO 17:54] rmse : 0.5149440169334412
[INFO 17:54] valid_rmse : 1.2559610605239868
[INFO 17:54] valid_loss : 1.6111088991165161
[INFO 18:02] - meta_params: 1.0
[INFO 18:08] rmse : 0.5062372088432312
[INFO 18:08] valid_rmse : 1.2347248792648315
[INFO 18:08] valid_loss : 1.6119935512542725
[INFO 18:16] - meta_params: 0.5
[INFO 18:21] rmse : 0.5129086971282959
[INFO 18:21] valid_rmse : 1.2509968280792236
[INFO 18:21] valid_loss : 1.6033880710601807
[INFO 18:29] - meta_params: 0.5
[INFO 18:34] rmse : 0.5284777283668518
[INFO 18:34] valid_rmse : 1.2889701128005981
[INFO 18:34] valid_loss : 1.6137195825576782
[INFO 18:42] - meta_params: 0.5
[INFO 18:48] rmse : 0.5189908146858215
[INFO 18:48] valid_rmse : 1.2658312320709229
[INFO 18:48] valid_loss : 1.6120353937149048
[INFO 18:55] - meta_params: 0.5
[INFO 19:01] rmse : 0.5062372088432312
[INFO 19:01] valid_rmse : 1.2347248792648315
[INFO 19:01] valid_loss : 1.6148450374603271
[INFO 19:08] - meta_params: 0.25
[INFO 19:14] rmse : 0.509327232837677
[INFO 19:14] valid_rmse : 1.242261528968811
[INFO 19:14] valid_loss : 1.6134617328643799
[INFO 19:21] - meta_params: 0.25
[INFO 19:26] rmse : 0.49315395951271057
[INFO 19:26] valid_rmse : 1.2028145790100098
[INFO 19:26] valid_loss : 1.5847105979919434
[INFO 19:34] - meta_params: 0.25
[INFO 19:39] rmse : 0.5062372088432312
[INFO 19:39] valid_rmse : 1.2347248792648315
[INFO 19:39] valid_loss : 1.5925235748291016
[INFO 19:46] - meta_params: 0.25
[INFO 19:52] rmse : 0.5139273405075073
[INFO 19:52] valid_rmse : 1.253481388092041
[INFO 19:52] valid_loss : 1.6011344194412231
[INFO 19:59] - meta_params: 0.25
[INFO 20:04] rmse : 0.5041667222976685
[INFO 20:04] valid_rmse : 1.2296749353408813
[INFO 20:04] valid_loss : 1.6060140132904053
[INFO 20:11] - meta_params: 0.125
[INFO 20:17] rmse : 0.5046851634979248
[INFO 20:17] valid_rmse : 1.230939507484436
[INFO 20:17] valid_loss : 1.606583595275879
[INFO 20:24] - meta_params: 0.125
[INFO 20:29] rmse : 0.5144359469413757
[INFO 20:29] valid_rmse : 1.2547218799591064
[INFO 20:29] valid_loss : 1.6060482263565063
[INFO 20:36] - meta_params: 0.125
[INFO 20:42] rmse : 0.5108652114868164
[INFO 20:42] valid_rmse : 1.2460126876831055
[INFO 20:42] valid_loss : 1.5993772745132446
[INFO 20:48] - meta_params: 0.0625
[INFO 20:54] rmse : 0.5199975967407227
[INFO 20:54] valid_rmse : 1.2682868242263794
[INFO 20:54] valid_loss : 1.6365822553634644
[INFO 21:01] - meta_params: 0.0625
[INFO 21:06] rmse : 0.5015665888786316
[INFO 21:06] valid_rmse : 1.2233331203460693
[INFO 21:06] valid_loss : 1.5901979207992554
[INFO 21:13] - meta_params: 0.0625
[INFO 21:18] rmse : 0.5098403692245483
[INFO 21:18] valid_rmse : 1.2435131072998047
[INFO 21:18] valid_loss : 1.6237120628356934
[INFO 21:25] - meta_params: 0.03125
[INFO 21:30] rmse : 0.5052030682563782
[INFO 21:30] valid_rmse : 1.2322026491165161
[INFO 21:30] valid_loss : 1.6017817258834839
[INFO 21:37] - meta_params: 0.03125
[INFO 21:42] rmse : 0.4979035556316376
[INFO 21:42] valid_rmse : 1.214398980140686
[INFO 21:42] valid_loss : 1.6067818403244019
[INFO 21:49] - meta_params: 0.03125
[INFO 21:54] rmse : 0.5072693228721619
[INFO 21:54] valid_rmse : 1.2372422218322754
[INFO 21:54] valid_loss : 1.609285593032837
[INFO 22:01] - meta_params: 0.015625
[INFO 22:06] rmse : 0.5067535638809204
[INFO 22:06] valid_rmse : 1.2359843254089355
[INFO 22:06] valid_loss : 1.6343631744384766
[INFO 22:13] - meta_params: 0.015625
[INFO 22:18] rmse : 0.5010449290275574
[INFO 22:18] valid_rmse : 1.2220607995986938
[INFO 22:19] valid_loss : 1.6144050359725952
[INFO 22:25] - meta_params: 0.015625
[INFO 22:30] rmse : 0.5015665888786316
[INFO 22:30] valid_rmse : 1.2233331203460693
[INFO 22:30] valid_loss : 1.6020126342773438
[INFO 22:37] - meta_params: 0.0078125
[INFO 22:42] rmse : 0.4979035556316376
[INFO 22:42] valid_rmse : 1.214398980140686
[INFO 22:42] valid_loss : 1.595027208328247
[INFO 22:48] - meta_params: 0.0078125
[INFO 22:54] rmse : 0.49737805128097534
[INFO 22:54] valid_rmse : 1.213117241859436
[INFO 22:54] valid_loss : 1.623288869857788
[INFO 23:00] - meta_params: 0.0078125
[INFO 23:06] rmse : 0.49737805128097534
[INFO 23:06] valid_rmse : 1.213117241859436
[INFO 23:06] valid_loss : 1.5929597616195679
[INFO 23:12] - meta_params: 0.00390625
[INFO 23:17] rmse : 0.5036478042602539
[INFO 23:17] valid_rmse : 1.2284092903137207
[INFO 23:17] valid_loss : 1.6004533767700195
[INFO 23:24] - meta_params: 0.00390625
[INFO 23:29] rmse : 0.5057203769683838
[INFO 23:29] valid_rmse : 1.2334643602371216
[INFO 23:29] valid_loss : 1.594932198524475
[INFO 23:29] -- END Training --
[INFO 23:29] ✅ Entraînement terminé en 546.13 secondes.
[INFO 23:29] train on cuda
[WARNING 23:39] Computing RM on meta and QUERY set
[INFO 23:42] RM: 0.049427276966979385
[WARNING 23:45] Computing RM on meta and QUERY set
[INFO 23:45] RM: 0.05533406758196665
[WARNING 23:48] Computing RM on meta and QUERY set
[INFO 23:48] RM: 0.06114593802332579
[WARNING 23:51] Computing RM on meta and QUERY set
[INFO 23:51] RM: 0.08508286988503246
[WARNING 23:53] Computing RM on meta and QUERY set
[INFO 23:53] RM: 0.09644066690336621
[WARNING 23:56] Computing RM on meta and QUERY set
[INFO 23:56] RM: 0.1066170958036386
[WARNING 23:59] Computing RM on meta and QUERY set
[INFO 23:59] RM: 0.11630381710344218
[WARNING 24:02] Computing RM on meta and QUERY set
[INFO 24:02] RM: 0.12578129107297342
[WARNING 24:04] Computing RM on meta and QUERY set
[INFO 24:04] RM: 0.13825964286157427
[WARNING 24:07] Computing RM on meta and QUERY set
[INFO 24:07] RM: 0.14990126934930864
[WARNING 24:10] Computing RM on meta and QUERY set
[INFO 24:10] RM: 0.1607785035824525
[WARNING 24:13] Computing RM on meta and QUERY set
[INFO 24:13] RM: 0.17082876184856946
[WARNING 24:15] Computing RM on meta and QUERY set
[INFO 24:16] RM: 0.182927820776108
[WARNING 24:18] Computing RM on meta and QUERY set
[INFO 24:18] RM: 0.19419816618007762
[WARNING 24:21] Computing RM on meta and QUERY set
[INFO 24:21] RM: 0.20470399843396792
[WARNING 24:24] Computing RM on meta and QUERY set
[INFO 24:24] RM: 0.21482417072689924
[INFO 24:24] Fold 0; pareto_index: 5.181822251973303; results: ({0: {'mi_acc': 0.6115145683288574, 'rmse': 0.6232860684394836, 'mae': 0.38848549127578735, 'mi_prec': 0.7907986044883728, 'mi_rec': 0.6420013904571533, 'mi_f_b': 0.7086736559867859, 'mi_auc': 0.5842620013817528, 'ma_prec': 0.5680797100067139, 'ma_rec': 0.5842620134353638, 'ma_f_b': 0.5628971457481384}, 1: {'mi_acc': 0.6172199249267578, 'rmse': 0.6186922788619995, 'mae': 0.3827801048755646, 'mi_prec': 0.7951388955116272, 'mi_rec': 0.6459802389144897, 'mi_f_b': 0.7128404378890991, 'mi_auc': 0.5916175779197433, 'ma_prec': 0.5741158723831177, 'ma_rec': 0.5916175842285156, 'ma_f_b': 0.5694839954376221}, 2: {'mi_acc': 0.6192946434020996, 'rmse': 0.6170132756233215, 'mae': 0.38070541620254517, 'mi_prec': 0.7942708134651184, 'mi_rec': 0.6480169892311096, 'mi_f_b': 0.7137285470962524, 'mi_auc': 0.5943573357928718, 'ma_prec': 0.5769034624099731, 'ma_rec': 0.5943573713302612, 'ma_f_b': 0.572808563709259}, 3: {'mi_acc': 0.6203320026397705, 'rmse': 0.6161720752716064, 'mae': 0.37966805696487427, 'mi_prec': 0.7942708134651184, 'mi_rec': 0.6489361524581909, 'mi_f_b': 0.714285671710968, 'mi_auc': 0.5957036063419042, 'ma_prec': 0.5781921148300171, 'ma_rec': 0.5957036018371582, 'ma_f_b': 0.5742989778518677}, 4: {'mi_acc': 0.6260373592376709, 'rmse': 0.6115248799324036, 'mae': 0.3739626705646515, 'mi_prec': 0.7907986044883728, 'mi_rec': 0.6549245119094849, 'mi_f_b': 0.7164766192436218, 'mi_auc': 0.6030674715214996, 'ma_prec': 0.5861209630966187, 'ma_rec': 0.6030674576759338, 'ma_f_b': 0.5836762189865112}, 5: {'mi_acc': 0.6275933980941772, 'rmse': 0.6102513074874878, 'mae': 0.37240666151046753, 'mi_prec': 0.7890625, 'mi_rec': 0.6567919254302979, 'mi_f_b': 0.7168769836425781, 'mi_auc': 0.6050503655219313, 'ma_prec': 0.5884745121002197, 'ma_rec': 0.6050503849983215, 'ma_f_b': 0.5864688158035278}, 6: {'mi_acc': 0.6307054162025452, 'rmse': 0.6076961755752563, 'mae': 0.3692946135997772, 'mi_prec': 0.7881944179534912, 'mi_rec': 0.6598837375640869, 'mi_f_b': 0.7183544635772705, 'mi_auc': 0.6089273677114931, 'ma_prec': 0.5925508141517639, 'ma_rec': 0.6089273691177368, 'ma_f_b': 0.5911049246788025}, 7: {'mi_acc': 0.6332988142967224, 'rmse': 0.6055586338043213, 'mae': 0.36670127511024475, 'mi_prec': 0.7881944179534912, 'mi_rec': 0.6622902750968933, 'mi_f_b': 0.7197779417037964, 'mi_auc': 0.6121146288795739, 'ma_prec': 0.5957724452018738, 'ma_rec': 0.6121146082878113, 'ma_f_b': 0.5946976542472839}, 8: {'mi_acc': 0.6343361139297485, 'rmse': 0.6047015190124512, 'mae': 0.36566391587257385, 'mi_prec': 0.7864583134651184, 'mi_rec': 0.6637362837791443, 'mi_f_b': 0.7199046611785889, 'mi_auc': 0.6133956629516132, 'ma_prec': 0.5974817276000977, 'ma_rec': 0.6133956909179688, 'ma_f_b': 0.596696138381958}, 9: {'mi_acc': 0.6405602097511292, 'rmse': 0.5995330214500427, 'mae': 0.3594398498535156, 'mi_prec': 0.7847222089767456, 'mi_rec': 0.6701260209083557, 'mi_f_b': 0.7229107618331909, 'mi_auc': 0.6209006607593932, 'ma_prec': 0.605634331703186, 'ma_rec': 0.6209006309509277, 'ma_f_b': 0.6057358384132385}, 10: {'mi_acc': 0.6431535482406616, 'rmse': 0.5973662734031677, 'mae': 0.35684648156166077, 'mi_prec': 0.7821180820465088, 'mi_rec': 0.6733931303024292, 'mi_f_b': 0.7236948013305664, 'mi_auc': 0.6239846976261052, 'ma_prec': 0.6094868779182434, 'ma_rec': 0.623984694480896, 'ma_f_b': 0.6100172400474548}, 11: {'mi_acc': 0.6473029255867004, 'rmse': 0.5938830971717834, 'mae': 0.35269710421562195, 'mi_prec': 0.7829861044883728, 'mi_rec': 0.6771771907806396, 'mi_f_b': 0.7262479662895203, 'mi_auc': 0.6288570449644275, 'ma_prec': 0.6144312024116516, 'ma_rec': 0.6288570165634155, 'ma_f_b': 0.615310549736023}, 12: {'mi_acc': 0.6462655663490295, 'rmse': 0.5947558283805847, 'mae': 0.35373446345329285, 'mi_prec': 0.7777777910232544, 'mi_rec': 0.6777609586715698, 'mi_f_b': 0.7243330478668213, 'mi_auc': 0.6276593620027661, 'ma_prec': 0.6144043803215027, 'ma_rec': 0.6276593208312988, 'ma_f_b': 0.6154226660728455}, 13: {'mi_acc': 0.6462655663490295, 'rmse': 0.5947558283805847, 'mae': 0.35373446345329285, 'mi_prec': 0.7690972089767456, 'mi_rec': 0.68049156665802, 'mi_f_b': 0.7220864295959473, 'mi_auc': 0.627785711831883, 'ma_prec': 0.616507351398468, 'ma_rec': 0.6277856826782227, 'ma_f_b': 0.6178191900253296}, 14: {'mi_acc': 0.6498963236808777, 'rmse': 0.5916956663131714, 'mae': 0.3501037657260895, 'mi_prec': 0.7664930820465088, 'mi_rec': 0.6850271821022034, 'mi_f_b': 0.7234740257263184, 'mi_auc': 0.6320284433954819, 'ma_prec': 0.6216486096382141, 'ma_rec': 0.6320284605026245, 'ma_f_b': 0.6232211589813232}, 15: {'mi_acc': 0.6530083417892456, 'rmse': 0.5890600085258484, 'mae': 0.34699171781539917, 'mi_prec': 0.7682291865348816, 'mi_rec': 0.687645673751831, 'mi_f_b': 0.7257072329521179, 'mi_auc': 0.6355545130896145, 'ma_prec': 0.6250939965248108, 'ma_rec': 0.6355544924736023, 'ma_f_b': 0.6267915368080139}}, {0: {'meta_doa': np.float64(0.4952647352403416), 'pc-er': 0.0540771484375, 'rm': 0.049427276966979385}, 1: {'meta_doa': np.float64(0.4970516693448033), 'pc-er': 0.076416015625, 'rm': 0.05533406758196665}, 2: {'meta_doa': np.float64(0.49775741737666424), 'pc-er': 0.08984375, 'rm': 0.06114593802332579}, 3: {'meta_doa': np.float64(0.49891748511012995), 'pc-er': 0.0980224609375, 'rm': 0.08508286988503246}, 4: {'meta_doa': np.float64(0.500675049616294), 'pc-er': 0.1060791015625, 'rm': 0.09644066690336621}, 5: {'meta_doa': np.float64(0.5031387258038128), 'pc-er': 0.1177978515625, 'rm': 0.1066170958036386}, 6: {'meta_doa': np.float64(0.5058467658829194), 'pc-er': 0.0885009765625, 'rm': 0.11630381710344218}, 7: {'meta_doa': np.float64(0.5083056738755978), 'pc-er': 0.09564208984375, 'rm': 0.12578129107297342}, 8: {'meta_doa': np.float64(0.5111175383861745), 'pc-er': 0.099365234375, 'rm': 0.13825964286157427}, 9: {'meta_doa': np.float64(0.5140122508176569), 'pc-er': 0.10858154296875, 'rm': 0.14990126934930864}, 10: {'meta_doa': np.float64(0.516267692908271), 'pc-er': 0.118408203125, 'rm': 0.1607785035824525}, 11: {'meta_doa': np.float64(0.5189411498054955), 'pc-er': 0.1253662109375, 'rm': 0.17082876184856946}, 12: {'meta_doa': np.float64(0.5211562098914687), 'pc-er': 0.1290283203125, 'rm': 0.182927820776108}, 13: {'meta_doa': np.float64(0.5241107479299452), 'pc-er': 0.1343994140625, 'rm': 0.19419816618007762}, 14: {'meta_doa': np.float64(0.5265964350235528), 'pc-er': 0.1795654296875, 'rm': 0.20470399843396792}, 15: {'meta_doa': np.float64(0.5284453276223309), 'pc-er': 0.184814453125, 'rm': 0.21482417072689924}})
